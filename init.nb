(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[    325390,       7860]
NotebookOptionsPosition[    324999,       7844]
NotebookOutlinePosition[    325407,       7861]
CellTagsIndexPosition[    325364,       7858]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Biostatistics`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<HypothesisTesting`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setup", "::", "usage"}], "=", 
   "\"\<Setup[] changes the current directory to the one where the current \
NoteBook is saved.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetUp", "::", "usage"}], "=", 
   "\"\<etUp[] changes the current directory to the one where the current \
NoteBook is saved.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setdown", "::", "usage"}], "=", 
   "\"\<Setdown[] changes the current directory to the defaul one.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDown", "::", "usage"}], "=", 
   "\"\<SetDown[] changes the current directory to the defaul one.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PB", "::", "usage"}], "=", "\"\<PB[] prints a blank line.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ordinalize", "::", "usage"}], "=", 
   "\"\<Ordinalize[integer] show the ordinalized number of the \
integer.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinToHourMinSec", "::", "usage"}], "=", 
   "\"\<MinToHourMinSec[minute] retruns {hour, minute, second} converted from \
minute.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HourMinSecToSec", "::", "usage"}], "=", 
   "\"\<HourMinSecToSec[hour, min, sec] returns time in seconds.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawSecToHourMinSec", "::", "usage"}], "=", 
   "\"\<rawSecToHourMinSec[sec] returns {hour, min, sec} from a time in \
seonds.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DateTime", "::", "usage"}], "=", 
   "\"\<DateTime[vec] shows time in the form of Date YYYY,MM,DD, Hour \
hour,min,sec\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PresentTime", "::", "usage"}], "=", 
   "\"\<PresentTime shows the present time.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DayTime", "::", "usage"}], "=", 
   "\"\<DayTime[] shows the present time in details.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinDataItems", "::", "usage"}], "=", 
   "\"\<JoinDataItems[data, items] joins the data with the second column in \
the items.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NF", "::", "usage"}], "=", 
   "\"\<NF[number, n] shows an approximate value of a number with n digits.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CutLast", "::", "usage"}], "=", 
   "\"\<CutLast[vec] removed the last element in a vecotr of vec\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Numberings", "::", "usage"}], "=", 
   "\"\<Numberings[list] prepends a running number to each entitiy of a list.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NPosition", "::", "usage"}], "=", 
   "\"\<NPosition[list, ele] returns a position of ele in list which is \
flattened.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RealVectorQ", "::", "usage"}], " ", "=", " ", 
   "\"\<RealVectorQ[{yy,mm,dd,hh,mm,ss}] affirms that the argument is a \
vector of numeric elements.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NullRemoving", "::", "usage"}], "=", 
   "\"\<NullRemoving[list] returns a list that does not contain the element \
Null without changing the original order of elements in the list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NullCleaning", "::", "usage"}], "=", 
   "\"\<NullCleaning[list] returns a list that do not contain a vector which \
contains Null without changing the original order of elements in the \
list.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringRemoving", "::", "usage"}], "=", 
   "\"\<StringRemovming[list] removes non-number entities from a list.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeElement", "::", "usage"}], "=", 
   "\"\<TakeElement[list, n, ele] takes records that have an element of ele \
in the n-th column.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FilterElement", "::", "usage"}], "=", 
   "\"\<FilterElement[list, n, func] takes records that yields True when the \
function of func is applied to the element in the n-th column.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeTwin", "::", "usage"}], "=", 
   "\"\<MakeTwin[vector1, vector2] makes pairs of elemets from vector1 and \
vector2, both of which have the same length.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fuse", "::", "usage"}], "=", 
   "\"\<Fuse[list1, list2] contatenates two lists, list1 and list2, \
horizontally.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NMean", "::", "usage"}], "=", 
   "\"\<NMean[list] enable to execute the built-in function Mean even to a \
list which contains non-number entities.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NStandardDeviation", "::", "usage"}], "=", 
   "\"\<NStandardDeviation[list] enable to execute the built-in function \
StandardDeviation even to a list which contains non-number entities.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NMedian", "::", "usage"}], "=", 
   "\"\<NMedian[vector] returns a median value of the vector.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMax", "::", "usage"}], "=", 
    "\"\<NMax[list] enable to execute the built-in function Max even to a \
list which contains non-number entities.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMin", "::", "usage"}], "=", 
    "\"\<NMin[list] enable to execute the built-in function Min even to a \
list which contains non-number entities.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ErrorMessage", "::", "usaeg"}], "=", 
   "\"\<ErrorMessage[string] prints string in green. ErrorMessage[string1, \
string2] prints joined errormessage. The color of fonts can be s by {r, b, g} \
vector placed after the string.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NFindFile", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<NFindFile[filename] searchs for a pass of a spreadsheet called \
filename. The extention of the filename can be omitted.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NFindFile3", "::", "usage"}], "=", "\[IndentingNewLine]", 
   "\"\<NFindFile3[filename] searchs for a pass of a spreadsheet called \
filename and returns True or False. The extention of the filename can be \
omitted.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntactComplement", "::", "usage"}], "=", 
   "\"\<IntactComplement[list1, list2] returns a list that is a relative \
complement of list2 with respect of list1 without changing the original order \
of elements in the list1.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cleandata", "::", "usage"}], "=", 
   "\"\<cleandata[list] is used in the DataIn[] function to change some \
elements in the imported data file into those in the executable \
format.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportExcel", "::", "usage"}], "=", 
   "\"\<ExportExcel[body, head, name] export a dataset with body as the main \
body of data and head as the running-numbered vairalbes names as an Excel \
file with a file name of name and the time when the file is exported.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportExcel2", "::", "usage"}], "=", 
   "\"\<ExportExcel2[body, head, name] export a dataset with body as the main \
body of data and head as the running-numbered vairalbes names as an Excel \
file with a file name of name and the time when the file is exported.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportExcel3", "::", "usage"}], "=", 
   "\"\<ExportExcel3[body, head, name] export a dataset with body as the main \
body of data and head as the running-numbered vairalbes names as an Excel \
file with a file name of name.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListNormalize", "::", "usage"}], "=", 
   "\"\<ListNormalize[body, head] normalizes the matrix data with body as its \
numeric data and head as the runnning-numbered item names\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NRandomSample", "::", "usage"}], "=", 
    "\"\<NRandomSample[vec, int, seed] generates a vector of random \
permutation of a number of int count taken from a vector of vec without \
permitting an overlap of elements with a seed of seed.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullChecker", "::", "usage"}], "=", 
    "\"\<NullChecker[list, items] interpolate null cells in a matrix of list \
with its head names as items.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NGetCorrelation", "::", "usage"}], "=", 
    "\"\<NGetCorrelation[list, items] returns correlation coefficents of each \
explanatory variable and the target variable. The list is a matrix with its \
last column as the target varialbes and other columns as explanatory \
variables.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowConfusionMatrix2", "::", "usage"}], "=", 
    "\"\<ShowConfusionMatrix2[pairs, cutoff] shows the result of statistical \
analyses with a dataset of pairs that is composed of a list of {predicted \
value, obersved value} with a cutoff of cutoff as a theahold of predicted \
value to make it dichotomous. The observed value is either 1 or 0.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cStatistics", "::", "usage"}], "=", 
    "\"\<cStatistics[pairs] returns a c-statistics value from a dataset of \
{predicted value, obseved value. The observed value consists of 1 or \
0.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeterminationCoefficient", "::", "usage"}], "=", 
    "\"\<DeterminationCoefficient[observed_values, estimated_values] resturns \
a determination coefficient, R^2.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataIn", "::", "usage"}], "=", 
    "\"\<DataIn[] imports a spread sheet file and makes executable lists \
without deleting empty records. The body of data is expressed by DATA or \
DATA[1], DATA[2], ....., if the file is composed of multiple sheets. The \
first row of the sheet is expressed by ITEMS or ITEMS[1], ITEMS[2], ..... \
that are running-numberd. In the typical setting of an Excel file to be \
imported for survival rate analyses, the 1st, 2nd, 3rd, 4th colums should be \
ID number(dummy column), starting date, ending(death or lost) date, censored \
date. The 1st column is not considered in the calcualtion and could be \
omitted.  The date should be enterd in the spread sheet file in a format of \
{2012,3,4}, 2012/3/4 or 2012,3,4. It is also allowed to enter the date and \
time of day like {2012,3,4,14,31,23} that is {yy, mm, dd, hh, mm, ss}. The \
4th column and later in the sheet should be data of the characteristics or \
risk factors of each subject, like age, gender, ht, wt, and so on. Both \
numeric and symbolic inputs are allowed. It is expected in the programs of \
this package that each row represents the data for one subject and that each \
column represents items needed for survival rate analyses, such as ID, dates \
needed for the analysis, risk factors and background variables.\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PruneEnsembleVariables", "::", "usage"}], "=", 
    "\"\<PruneEnsembleVariables[function] returns a list of variables that \
are used in teh function. The function is in a form of Function in \
Mathematica.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"ROC", " ", "curve"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "::", "usage"}], "=", 
    "\"\<ToROCAssociation[ {trueLabel, falseLabel}, actualLabels, \
predictedLabels] converts two labels lists (actual and predicted) into an \
Association that can be used as an argument for the ROC functions. See \
ROCFunctions .\>\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCAssociationQ", "::", "usage"}], "=", 
    "\"\<Verifies that the argument is a valid ROC Association object. A ROC \
Association object has the keys \\\"TruePositive\\\", \\\"FalsePositive\\\", \
\\\"TrueNegative\\\", and \\\"FalseNegative\\\" .\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCFunctions", "::", "usage"}], "=", 
    "\"\<Gives access to the implement ROC functions.\nIt can be used as \
Thread[ROCFunctions[][rocAssoc]] or \
Thread[ROCFunctions[{\\\"TPR\\\",\\\"SPC\\\"}][rocAssoc]] .See \
ROCFunctions[\\\"FunctionInterpretations\\\"] for available functions and \
their interpretations.\>\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "::", "usage"}], "=", 
    "\"\<Makes a standard ROC plot for specified parameter list and \
corresponding ROC Association objects. ROCPlot takes all options of Graphics \
and additional options for ROC points size, color, callouts, tooltips, and \
joining. The allowed signatures are: \\nROCPlot[ aROCs:{_?ROCAssociationQ..}, \
opts] \\nROCPlot[ parVals:({_?NumericQ..}|Automatic), \
aROCs:{_?ROCAssociationQ..}, opts] \\nROCPlot[ xFuncName_String, \
yFuncName_String, aROCs:{_?ROCAssociationQ..}, opts] \\nROCPlot[ \
xFuncName_String, yFuncName_String, parVals:({_?NumericQ..}|Automatic), \
aROCs:{_?ROCAssociationQ..}, opts]\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "::", "usage"}], "=", 
    "\"\<ROCValues[predictionProbabilities_Dataset, actualLabels_List, \
thRange_?VectorQ ] computes ROC associations (for ROCPlot).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToClassifyROCCurvePlot", "::", "usage"}], "=", 
    "\"\<Changes the style of ROCPlot plots. (Experimental.)\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConfusionMatrixPlot", "::", "usage"}], "=", 
    "\"\<ConfusionMatrixPlot[ aROC_?ROCAssociationQ, labelNames: {yesLabel_, \
noLabel_}\nplots a confusion matrix based on a ROC association.\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConfusionMatrixPlotFrame", "::", "usage"}], "=", 
    "\"\<ConfusionMatrixPlotFrame[mat, refMat, rowNames, columnNames, opts]\n\
frames a given confusion matrix.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TPR", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SPC", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPV", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NPV", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPR", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDR", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FNR", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ACC", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FOR", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F1", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AUROC", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MCC", "::", "usasge"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aROCAcronyms", "::", "usasge"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aROCFunctions", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCSpecQ", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], "    ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Path", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"ToFileName", "[", 
         RowBox[{"{", 
          RowBox[{"$HomeDirectory", ",", "\"\<desktop\>\""}], "}"}], "]"}], 
        ",", " ", "\"\</Library/Mathematica/Autoload/Labodata\>\"", ",", " ", 
        "\"\</Library/WolframDesktop/Autoload/Labodata\>\"", ",", 
        "\"\</Users/spaceblue/Documents\>\"", ",", 
        "\"\</Users/spaceblue/Documents/jsdt\>\"", ",", "\n", 
        "\"\<C:\\\\ProgramData\\\\Mathematica\\\\Autoload\\\\Labodata\>\""}], 
       "}"}], ",", " ", "$Path"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Setup", "[", "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"current", ",", " ", "input"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"current", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", " ", 
        "\"\<                                                 \>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{
          "StringForm", "[", 
           "\"\<\[FilledSquare] Setting the Working Directory to the \
Directory where this notebook was SAVED\>\"", "]"}], ",", "Bold", ",", "16", 
          ",", "Purple"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", " ", 
        "\"\<                                                 \>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<notesave\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"current", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{
             "StringForm", "[", 
              "\"\<Frist, save this notebook.\\nAnd Press OK to set up the \
working directory.\>\"", "]"}], ",", " ", "Bold", ",", " ", "Red", ",", " ", 
             "15"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", " ", 
           "\"\<                                                 \>\"", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"input", "=", 
           RowBox[{"InputString", "[", 
            RowBox[{
            "\"\<Press OK AFTER SAVING this notebook.\\nType end to \
quit.\>\"", ",", " ", 
             RowBox[{"WindowMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", " ", "10"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", " ", "10"}], "}"}]}], "}"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"input", "===", "\"\<end\>\""}], "||", 
             RowBox[{"input", "===", "\"\<quit\>\""}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Goto", "[", "\"\<setupending\>\"", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"input", "===", "\"\<\>\""}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], "=!=", "$Failed"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<The previous working directory was ``\>\"", ",", " ", 
                  RowBox[{"Directory", "[", "]"}]}], "]"}], ",", "Bold", ",", 
                "15"}], "]"}], "]"}], ";", 
             RowBox[{"Goto", "[", "\"\<next\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"input", "===", "\"\<\>\""}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], "===", "$Failed"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "ErrorMessage", "[", 
              "\"\<This notebook is not saved. Save it, first.\>\"", "]"}], 
             ";", 
             RowBox[{"Goto", "[", "\"\<notesave\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ErrorMessage", "[", "\"\<Unexpected error\>\"", "]"}], 
             ";", 
             RowBox[{"Goto", "[", "\"\<setupending\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<The previous working directory was ``\>\"", ",", " ", 
              RowBox[{"Directory", "[", "]"}]}], "]"}], ",", "Bold", ",", " ",
             "15"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<next\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<\[FilledDiamond] The working directory has been changed to ``\
\>\"", ",", " ", 
            RowBox[{"Directory", "[", "]"}]}], "]"}], ",", "16", ",", "Bold", 
          ",", "Blue"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", " ", 
        "\"\<                                                 \>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{
          "StringForm", "[", 
           "\"\<The Working Directory can be returned to the HOME Directory \
by running Setdown[] command.\>\"", "]"}], ",", " ", "Bold", ",", "15"}], 
         "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", " ", 
        "\"\<                                                 \>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<setupending\>\"", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetUp", "[", "]"}], ":=", 
    RowBox[{"Setup", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Setdown", "[", "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"current", ",", " ", "input", ",", " ", "home"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"current", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"home", "=", "$HomeDirectory"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", " ", 
        "\"\<                                                 \>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{
          "StringForm", "[", 
           "\"\<\[FilledSquare] Returning the Working Directory to the HOME \
Directory\>\"", "]"}], ",", "Bold", ",", "16", ",", "Purple"}], "]"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", " ", 
        "\"\<                                                 \>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<notesave\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"current", "===", "$Failed"}], "&&", 
          RowBox[{
           RowBox[{"Directory", "[", "]"}], "===", "home"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[EmptyDiamond] The current Working directory is already \
the HOME directory ``\>\"", ",", " ", "home"}], "]"}], ",", "Bold", ",", 
             "16"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", " ", 
           "\"\<                                                 \>\"", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Goto", "[", "\"\<setdownending\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"current", "===", "$Failed"}], "&&", 
          RowBox[{
           RowBox[{"Directory", "[", "]"}], "=!=", "home"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[EmptyDiamond] The current Working directorywas ``\>\"", 
               ",", 
               RowBox[{"Directory", "[", "]"}]}], "]"}], ",", "Bold", ",", 
             "16"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[FilledDiamond] The working directory has been changed to \
the HOME directory ``\>\"", ",", " ", 
               RowBox[{"Directory", "[", "]"}]}], "]"}], ",", "16", ",", 
             "Bold", ",", "Blue"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{
          "Print", "[", " ", 
           "\"\<                                                 \>\"", 
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"current", "=!=", "$Failed"}], "&&", 
          RowBox[{
           RowBox[{"Directory", "[", "]"}], "=!=", "home"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[EmptyDiamond] The current Working directory was ``\>\"", 
               ",", 
               RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], ",", "Bold", 
             ",", "16"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[FilledDiamond] The working directory  has been changed \
to the HOME directory ``\>\"", ",", " ", 
               RowBox[{"Directory", "[", "]"}]}], "]"}], ",", "16", ",", 
             "Bold", ",", "Blue"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{
          "Print", "[", " ", 
           "\"\<                                                 \>\"", 
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"current", "=!=", "$Failed"}], "&&", 
          RowBox[{
           RowBox[{"Directory", "[", "]"}], "===", "home"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[EmptyDiamond] The current Working directory was already \
the HOME directory ``\>\"", ",", " ", "home"}], "]"}], ",", "Bold", ",", 
             "15"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", " ", 
           "\"\<                                                 \>\"", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Goto", "[", "\"\<setdownending\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ErrorMessage", "[", "\"\<Unexpected Error.\>\"", "]"}], 
          ";", 
          RowBox[{"Goto", "[", "\"\<setdownending\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<setdownending\>\"", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetDown", "[", "]"}], ":=", 
    RowBox[{"Setdown", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PB", "[", "]"}], ":=", " ", 
    RowBox[{"Print", "[", "\"\<                              \>\"", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ordinalize", "[", "m_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "letters", ",", " ", "lastL", ",", " ", "rest"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\:6574\:6570\:3092\:5e8f\:6570\:306b\:5909\:3048\:308b", "\:3002", 
        RowBox[{"1", "st"}], ",", " ", 
        RowBox[{"2", "nd"}], ",", " ", 
        RowBox[{"3", "rd"}], ",", " ", 
        RowBox[{"4", "th"}], ",", " ", 
        RowBox[{"...", ".."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"ToExpression", "@", "m"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerQ", "@", "n"}], "&&", 
          RowBox[{"Positive", "@", "n"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"letters", "=", 
           RowBox[{"StringSplit", "[", 
            RowBox[{
             RowBox[{"ToString", "@", "n"}], ",", " ", "\"\<\>\""}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"lastL", "=", 
           RowBox[{"Last", "@", "letters"}]}], ";", 
          RowBox[{"LASTL", "=", "lastL"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rest", "=", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "letters"}], "===", "1"}], ",", " ", 
             RowBox[{"{", "\"\<\>\"", "}"}], ",", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"letters", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "===", "1"}], ",", " ", "\"\<1st\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"n", "===", "2"}], ",", " ", "\"\<2nd\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"n", "===", "3"}], ",", " ", "\"\<3rd\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "4", "\[LessEqual]", " ", "n", "\[LessEqual]", " ", "20"}], ",", 
            " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
              RowBox[{"ToString", "@", "n"}], ",", " ", "\"\<th\>\""}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"n", "\[GreaterEqual]", " ", "21"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"lastL", "===", "\"\<1\>\""}], ",", " ", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringJoin", "[", "rest", "]"}], ",", " ", 
                "\"\<1st\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"lastL", "===", "\"\<2\>\""}], ",", " ", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringJoin", "[", "rest", "]"}], ",", " ", 
                "\"\<2nd\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"lastL", "===", "\"\<3\>\""}], ",", " ", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringJoin", "[", "rest", "]"}], ",", " ", 
                "\"\<3rd\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
              "True", ",", "  ", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringJoin", "[", "letters", "]"}], ",", " ", 
                "\"\<th\>\""}], "]"}]}], "\[IndentingNewLine]", "\t", "]"}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
            " ", "m"}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", "m"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinToHourMinSec", "[", "ele_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", ",", "m", ",", "s"}], "}"}], ",", "\n", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"NumberQ", "[", "ele", "]"}], ",", "\n", 
        RowBox[{
         RowBox[{"h", "=", 
          RowBox[{"Floor", "[", 
           RowBox[{"ele", "/", "60."}], "]"}]}], ";", 
         RowBox[{"m", "=", 
          RowBox[{"Floor", "[", 
           RowBox[{"ele", "-", 
            RowBox[{"h", "*", "60"}]}], "]"}]}], ";", " ", 
         RowBox[{"s", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ele", "-", 
             RowBox[{"h", "*", "60"}], "-", "m"}], " ", ")"}], "*", "60"}]}], 
         ";", "\n", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m", ",", 
           RowBox[{"Floor", "[", "s", "]"}]}], "}"}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "ErrorMessage", "[", "\"\<The input must be a number.\>\"", "]"}], 
         ";", "ele"}], ",", " ", 
        RowBox[{
         RowBox[{
         "ErrorMessage", "[", "\"\<The input must be a number.\>\"", "]"}], 
         ";", "ele"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HourMinSecToSec", "[", "vec_", "]"}], ":=", "\n", 
    RowBox[{"Which", "[", " ", 
     RowBox[{
      RowBox[{"vec", "===", "Null"}], ",", " ", "Null", ",", 
      RowBox[{
       RowBox[{"RealVectorQ", "[", 
        RowBox[{"vec", ",", "3"}], "]"}], "||", 
       RowBox[{"RealVectorQ", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", "vec", "]"}], ",", "3"}], "]"}]}], ",", 
      
      RowBox[{
       RowBox[{"vec", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{"60", "*", 
        RowBox[{"vec", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "+", 
       RowBox[{"60", "*", "60", "*", 
        RowBox[{"vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", "True", ",", " ", 
      "Null"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rawSecToHourMinSec", "[", "sec_", "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fullsec", "=", "Null"}], ",", " ", "hour", ",", " ", "min", 
        ",", " ", "secon"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sec", "]"}], "===", "0"}], ",", " ", 
         RowBox[{"fullsec", "=", "sec"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "sec", "]"}], "===", "1"}], "||", 
          RowBox[{
           RowBox[{"Length", "[", "sec", "]"}], "===", "2"}]}], ",", "\n", 
         RowBox[{"fullsec", "=", 
          RowBox[{"sec", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "True", ",", 
         RowBox[{"Print", "[", "\"\<StoHMSerror\>\"", "]"}]}], "]"}], ";", 
       "\n", 
       RowBox[{"Which", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberQ", "[", "fullsec", "]"}], "&&", 
          RowBox[{"fullsec", "\[GreaterEqual]", " ", "0"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"hour", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{"N", "[", 
             RowBox[{"fullsec", "/", 
              RowBox[{"(", 
               RowBox[{"60", " ", "60"}], ")"}]}], "]"}], "]"}]}], ";", "\n", 
          
          RowBox[{"min", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"fullsec", "-", 
                RowBox[{"60", " ", "60", "hour"}]}], ")"}], "/", "60."}], 
             "]"}], "]"}]}], ";", "\n", 
          RowBox[{"secon", "=", 
           RowBox[{"Round", "[", 
            RowBox[{"fullsec", "-", 
             RowBox[{"60", " ", "60", " ", "hour"}], "-", 
             RowBox[{"60", "min"}]}], "]"}]}], ";", "\n", 
          RowBox[{"{", 
           RowBox[{"hour", ",", "min", ",", "secon"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NumberQ", "@", "fullsec"}], "&&", 
          RowBox[{"fullsec", "<", "0"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"hour", "=", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"N", "[", 
             RowBox[{"fullsec", "/", 
              RowBox[{"(", 
               RowBox[{"60", " ", "60"}], ")"}]}], "]"}], "]"}]}], ";", "\n", 
          
          RowBox[{"min", "=", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"fullsec", "-", 
                RowBox[{"60", " ", "60", "hour"}]}], ")"}], "/", "60."}], 
             "]"}], "]"}]}], ";", "\n", 
          RowBox[{"secon", "=", 
           RowBox[{"Round", "[", 
            RowBox[{"fullsec", "-", 
             RowBox[{"60", " ", "60", " ", "hour"}], "-", 
             RowBox[{"60", "min"}]}], "]"}]}], ";", "\n", 
          RowBox[{"{", 
           RowBox[{"hour", ",", "min", ",", "secon"}], "}"}]}], ",", 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<error\>\"", ",", "\"\<error\>\"", ",", "\"\<error\>\""}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DateTime", "[", 
     RowBox[{"vec_", ",", " ", "opt___"}], "]"}], ":=", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"RealVectorQ", "[", "vec", "]"}], "&&", 
       RowBox[{
        RowBox[{"Length", "@", "vec"}], "===", "6"}]}], ",", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Date", "[", "]"}], "\:306e\:51fa\:529b\:3092"}], "\:3001", 
        "\:5e74\:6708\:65e5\:3068\:6642\:5206\:79d2\:306b\:5206\:3051\:3066\
\:8868\:793a", "\:3002", "opt\:306fSyle\:306eparamter"}], " ", "*)"}], "\n", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Date: ``, ``, ``, Hour: ``, ``, ``\>\"", ",", " ", 
          RowBox[{"vec", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"vec", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{"vec", "[", 
             RowBox[{"[", "6", "]"}], "]"}], ",", "4"}], "]"}]}], "]"}], ",", 
        " ", "opt"}], "]"}], ",", "Null", ",", "Null"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PresentTime", ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Map", "[", " ", 
      RowBox[{"ToString", ",", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Date", "[", "]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", " ", 
         RowBox[{"Floor", "[", " ", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"Date", "[", "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DayTime", "[", "opts___", "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"day", ",", " ", "time0", ",", "time"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"day", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Now", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time0", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Now", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"time0", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"time0", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Round", "[", 
           RowBox[{"time0", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<\[FilledDiamond] Present Time: ``\:5e74 ``\:6708 ``\:65e5\
\:3000``\:6642 ``\:5206 ``\:79d2\>\"", ",", " ", 
            RowBox[{"day", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"day", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"day", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"time", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"time", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"time", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", "opts"}], 
         "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JoinDataItems", "[", 
     RowBox[{"data_", ",", " ", "items_"}], "]"}], ":=", "\n", " ", 
    RowBox[{"Prepend", "[", 
     RowBox[{"data", ",", " ", 
      RowBox[{"items", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], " ", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NF", "[", 
     RowBox[{"numb_", ",", " ", 
      RowBox[{"digit_", ":", "4"}]}], "]"}], ":=", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"NumberQ", "[", "numb", "]"}], "===", "False"}], ",", " ", 
      "Null", ",", " ", 
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{"N", "[", "numb", "]"}], ",", "digit"}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CutLast", "[", "list_", "]"}], ":=", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "list", "]"}], ">", "0"}], ",", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"list", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", " ", "list", ",", " ", "list"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Numberings", "[", 
     RowBox[{"list_", "?", "ListQ"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"MakeTwin", "[", " ", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "list", "]"}], "]"}], ",", "list"}], " ", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NPosition", "[", 
     RowBox[{"list_", ",", " ", "ele_"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", " ", 
     RowBox[{"Position", "[", " ", 
      RowBox[{"list", ",", " ", "ele"}], "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeTwin", "[", " ", 
     RowBox[{"data1_", ",", " ", "data2_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "data1", "]"}], "===", 
       RowBox[{"Length", "[", "data2", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", " ", 
       RowBox[{"{", 
        RowBox[{"data1", ",", "data2"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{"MakeTwin", "::", "badarg"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeTwin", "::", "badarg"}], "=", 
    "\"\<The lengths of two arguments must be equal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeTwin", "[", 
     RowBox[{"{", 
      RowBox[{"data1_", ",", " ", "data2_"}], "}"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"MakeTwin", "[", 
     RowBox[{"data1", ",", " ", "data2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fuse", "[", 
     RowBox[{"vec1_", ",", " ", "vec2_"}], "]"}], ":=", "\n", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim1", "=", 
         RowBox[{"Dimensions", "[", "vec1", "]"}]}], ",", 
        RowBox[{"dim2", "=", 
         RowBox[{"Dimensions", "[", "vec2", "]"}]}], ",", " ", 
        RowBox[{"output", "=", "Null"}]}], "}"}], ",", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{"vec1", ",", " ", 
        RowBox[{
        "vec2", " ", 
         "\:306b\:306f\:540c\:3058\:9577\:3055\:306e\:30ea\:30b9\:30c8\:304c\
\:305d\:308c\:305e\:308c\:6765\:308b"}]}], " ", "*)"}], "\n", 
      RowBox[{
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"dim1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "=!=", 
          RowBox[{"dim2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", " ", 
           "\"\<The lengths of both data must be equal.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "ending", "]"}]}]}], "]"}], ";", "\n", 
       RowBox[{"Which", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dim1", "]"}], "===", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Length", "[", "dim2", "]"}], " ", "===", "1"}]}], ",", 
         "\n", 
         RowBox[{"output", "=", 
          RowBox[{"MapThread", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"vec1", ",", "vec2"}], "}"}]}], "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dim1", "]"}], ">=", " ", "2"}], " ", "&&", 
          " ", 
          RowBox[{
           RowBox[{"Length", "[", "dim2", "]"}], "===", "1"}]}], ",", "\n", 
         RowBox[{"output", "=", 
          RowBox[{"MapThread", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"vec1", ",", " ", "vec2"}], "}"}]}], "]"}]}], ",", "\n", 
         
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dim1", "]"}], "===", "1"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "dim2", "]"}], ">=", " ", "2"}]}], ",", 
         "\n", 
         RowBox[{"output", " ", "=", " ", 
          RowBox[{"MapThread", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"vec1", ",", " ", "vec2"}], "}"}]}], "]"}]}], ",", "\n", 
         
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "dim1", "]"}], ">=", " ", "2"}], " ", "&&", 
          " ", 
          RowBox[{
           RowBox[{"Length", "[", "dim2", "]"}], ">=", " ", "2"}]}], ",", 
         "\n", 
         RowBox[{"output", " ", "=", " ", 
          RowBox[{"MapThread", "[", " ", 
           RowBox[{"Join", ",", " ", 
            RowBox[{"{", 
             RowBox[{"vec1", ",", "vec2"}], "}"}]}], "]"}]}], ",", "\n", 
         "True", ",", "\n", 
         RowBox[{
          RowBox[{"ErrorMessage", "[", "\"\<Fuse error\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "ending", "]"}]}]}], "\n", "]"}], ";", "\n", 
       RowBox[{"Label", "[", "ending", "]"}], ";", "\n", "output"}]}], "\n", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fuse", "[", 
     RowBox[{"{", 
      RowBox[{"vec1_", ",", "vec2_"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Fuse", "[", 
     RowBox[{"vec1", ",", "vec2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullRemoving", "[", "list_", "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"DeleteCases", "[", " ", 
     RowBox[{"list", ",", " ", "Null"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullCleaning", "[", "list_", "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"IntactComplement", "[", 
     RowBox[{
      RowBox[{"Map", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", " ", "Null"}], "]"}], "||", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", " ", "\"\<Null\>\""}], "]"}]}], ",", "Null", 
           ",", " ", "#"}], "]"}], "&"}], ",", " ", "list"}], "]"}], ",", " ", 
      RowBox[{"{", "Null", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringRemoving", "[", "list_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", " ", "x"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], ":=", " ", 
        RowBox[{"If", "[", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"NumberQ", "[", "x", "]"}], "===", "False"}], ",", " ", 
          "Null", ",", " ", "x", ",", " ", "Null"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NullRemoving", "[", " ", 
        RowBox[{"Map", "[", " ", 
         RowBox[{"f", ",", " ", "list"}], " ", "]"}], " ", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TakeElement", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"list_", "?", "ListQ"}], ",", " ", 
        RowBox[{"n_", "?", "IntegerQ"}]}], "}"}], ",", " ", "ele_"}], "]"}], ":=",
     "\n", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"output", " ", "=", " ", "Null"}], ",", " ", "column", ",", 
        " ", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"list", "===", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"n", " ", "<=", " ", "0"}], " ", "||", " ", 
          RowBox[{"n", " ", ">", 
           RowBox[{
            RowBox[{"Dimensions", "[", "list", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\n", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<TakeElement Error : inapproapriate n\>\"",
            "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}]}], " ", "]"}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"column", " ", "=", " ", 
        RowBox[{"list", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "n"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", " ", 
           RowBox[{
            RowBox[{"Union", "[", " ", "column", "]"}], " ", ",", " ", 
            "ele"}], " ", "]"}], " ", "=!=", " ", "True"}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"ErrorMessage", "[", 
            RowBox[{
            "ele", ",", " ", 
             "\"\<not included in the designated column.\>\""}], "]"}], ";"}],
           " ", "*)"}], 
         RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}], " ", "]"}], ";", 
       "\n", "\n", 
       RowBox[{"output", " ", "=", " ", 
        RowBox[{"Part", "[", " ", 
         RowBox[{"list", ",", " ", 
          RowBox[{"Flatten", "[", " ", 
           RowBox[{"Position", "[", " ", 
            RowBox[{"column", ",", " ", "ele"}], " ", "]"}], " ", "]"}]}], 
         " ", "]"}]}], ";", "\n", "\n", 
       RowBox[{"Label", "[", "\"\<ending\>\"", "]"}], ";", "\n", "output"}]}],
      " ", "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TakeElement", "[", 
     RowBox[{
      RowBox[{"list_", "?", "ListQ"}], ",", " ", 
      RowBox[{"n_", "?", "IntegerQ"}], ",", " ", "ele_"}], "]"}], ":=", " ", 
    RowBox[{"TakeElement", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", ",", "n"}], "}"}], ",", "ele"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FilterElement", "[", 
     RowBox[{
      RowBox[{"list_", "?", "ListQ"}], ",", " ", 
      RowBox[{"n_", "?", "IntegerQ"}], ",", " ", "func_"}], "]"}], ":=", "\n", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"len", ",", "data", ",", " ", "pos", ",", " ", 
        RowBox[{"output", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"list", "===", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"SyntaxQ", "[", " ", 
           RowBox[{"ToString", "[", " ", "func", " ", "]"}], " ", "]"}], "===",
           "False"}], ",", "\n", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The func must be a syntax.\>\"", "]"}], 
          ";", 
          RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}]}], " ", "]"}], ";", 
       "\n", 
       RowBox[{"len", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "list", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"n", " ", ">", " ", "len"}], " ", "||", " ", 
          RowBox[{"n", " ", "<", " ", "0"}]}], ",", " ", "\n", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", " ", 
           "\"\<The n must be a positive integer greater than the number of \
columns.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}]}], " ", "]"}], ";", 
       "\n", 
       RowBox[{"data", " ", "=", " ", 
        RowBox[{"list", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "n"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{"Position", "[", " ", 
          RowBox[{
           RowBox[{"Map", "[", " ", 
            RowBox[{"func", ",", " ", "data"}], " ", "]"}], ",", " ", 
           "True"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"output", "=", 
        RowBox[{"Part", "[", " ", 
         RowBox[{"list", ",", " ", "pos"}], "]"}]}], ";", "\n", 
       RowBox[{"Label", "[", "\"\<ending\>\"", "]"}], ";", "\n", "output"}]}],
      "\n", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FilterElement", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"list_", "?", "ListQ"}], ",", " ", 
        RowBox[{"n_", "?", "IntegerQ"}]}], "}"}], ",", " ", 
      RowBox[{"func_", "?", "SyntaxQ"}]}], "]"}], ":=", "\n", 
    RowBox[{"FilterElement", "[", 
     RowBox[{"list", ",", " ", "n", ",", " ", "func"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RealVectorQ", "[", 
     RowBox[{"vec_", ",", " ", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringFreeQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "vec", "]"}], ",", " ", "\"\<{\>\""}], 
          "]"}], "===", "False"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringFreeQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "vec", "]"}], ",", " ", "\"\<}\>\""}], 
          "]"}], "===", "False"}], ")"}], "&&", 
       RowBox[{"VectorQ", "[", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"N", "[", "vec", "]"}], "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"NumericQ", ",", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"N", "[", "vec", "]"}], "]"}]}], "]"}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], "&&", 
       RowBox[{
        RowBox[{"Length", "[", "vec", "]"}], "===", "n"}]}], ",", "True", ",",
       "False"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RealVectorQ", "[", "vect_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringFreeQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "vect", "]"}], ",", " ", "\"\<{\>\""}], 
          "]"}], "===", "False"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringFreeQ", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "vect", "]"}], ",", " ", "\"\<}\>\""}], 
          "]"}], "===", "False"}], ")"}], "&&", 
       RowBox[{"VectorQ", "[", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"N", "[", "vect", "]"}], "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"NumericQ", ",", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"N", "[", "vect", "]"}], "]"}]}], "]"}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}]}], ",", "True", ",", "False"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMean", "[", 
     RowBox[{"list_", "?", "ListQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"canda", ",", " ", "nmf", ",", " ", "nmele"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nmf", "[", "nmele_", "]"}], ":=", " ", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"NumberQ", "[", "nmele", "]"}], ",", " ", "1", ",", " ", 
          "0", ",", " ", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"canda", "=", 
        RowBox[{"NPosition", "[", 
         RowBox[{
          RowBox[{"Map", "[", " ", 
           RowBox[{"nmf", ",", " ", "list"}], "]"}], ",", "1"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "canda", "]"}], ">", "0"}], ",", " ", 
         RowBox[{"N", "[", " ", 
          RowBox[{"Mean", "[", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"list", ",", "canda"}], "]"}], "]"}], "]"}], ",", " ", 
         "Null", ",", " ", "Null"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NStandardDeviation", "[", 
     RowBox[{"list_", "?", "VectorQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cands", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"cands", " ", "=", " ", 
        RowBox[{"StringRemoving", "[", " ", "list", " ", "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cands", "]"}], "===", "0"}], ",", 
         "\[IndentingNewLine]", "\t\t", "Null", ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"Length", "[", "cands", "]"}], "===", "1"}], ",", 
         "\[IndentingNewLine]", "\t\t", "0", ",", " ", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"Length", "[", "cands", "]"}], "\[GreaterEqual]", " ", 
          "2"}], ",", "\[IndentingNewLine]", "\t ", 
         RowBox[{"N", "[", " ", 
          RowBox[{"StandardDeviation", "[", "  ", "cands", "]"}], " ", "]"}], 
         ",", " ", "\[IndentingNewLine]", "\t", "True", ",", " ", "Null"}], 
        " ", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMedian", "[", 
     RowBox[{"list_", "?", "ListQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"canda", ",", " ", "nmf", ",", " ", "nmele"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nmf", "[", "nmele_", "]"}], ":=", " ", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"NumberQ", "[", "nmele", "]"}], ",", " ", "1", ",", " ", 
          "0", ",", " ", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"canda", "=", 
        RowBox[{"NPosition", "[", 
         RowBox[{
          RowBox[{"Map", "[", " ", 
           RowBox[{"nmf", ",", " ", "list"}], "]"}], ",", "1"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "canda", "]"}], ">", "0"}], ",", " ", 
         RowBox[{"N", "[", " ", 
          RowBox[{"Median", "[", " ", 
           RowBox[{"Part", "[", 
            RowBox[{"list", ",", "canda"}], "]"}], "]"}], "]"}], ",", " ", 
         "Null", ",", " ", "Null"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMedian", "[", "list__", "]"}], ":=", " ", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"VectorQ", "[", 
        RowBox[{"{", "list", "}"}], "]"}], "===", "True"}], ",", 
      RowBox[{"NMedian", "[", 
       RowBox[{"{", "list", "}"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMax", "[", 
     RowBox[{"list_", "?", "VectorQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cands", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cands", " ", "=", 
        RowBox[{"StringRemoving", "[", " ", "list", " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cands", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Max", "[", "cands", "]"}], ",", " ", "Null", ",", " ", 
         "Null"}], " ", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMax", "[", "list__", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "can", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"can", "=", 
        RowBox[{"StringRemoving", "[", " ", 
         RowBox[{"Apply", "[", " ", 
          RowBox[{"List", ",", " ", 
           RowBox[{"Hold", "[", "list", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"can", " ", "===", 
          RowBox[{"{", "}"}]}], ",", " ", "Null", ",", " ", 
         RowBox[{"Max", "[", "can", "]"}]}], " ", "]"}]}]}], " ", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMin", "[", 
     RowBox[{"list_", "?", "VectorQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cands", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cands", " ", "=", " ", 
        RowBox[{"StringRemoving", "[", " ", "list", " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cands", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Min", "[", "cands", "]"}], ",", " ", "Null", ",", " ", 
         "Null"}], " ", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NMin", "[", "list__", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "can", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"can", "=", 
        RowBox[{"StringRemoving", "[", " ", 
         RowBox[{"Apply", "[", " ", 
          RowBox[{"List", ",", " ", 
           RowBox[{"Hold", "[", "list", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"can", " ", "===", 
          RowBox[{"{", "}"}]}], ",", " ", "Null", ",", " ", 
         RowBox[{"Min", "[", "can", "]"}]}], " ", "]"}]}]}], " ", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ErrorMessage", "[", "string_", "]"}], ":=", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{"string", ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0", ",", " ", "0.719463", ",", " ", "0.0528573"}], 
         "]"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ErrorMessage", "[", 
     RowBox[{"string_", ",", 
      RowBox[{"{", 
       RowBox[{"r_", ",", "g_", ",", "b_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{"string", ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"r", ",", "g", ",", "b"}], "]"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ErrorMessage", "[", 
     RowBox[{"string1_", ",", "string2_"}], "]"}], ":=", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "string1", "]"}], "<>", "\"\< : \>\"", "<>", 
        
        RowBox[{"ToString", "[", "string2", "]"}]}], ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0", ",", " ", "0.719463", ",", " ", "0.0528573"}], 
         "]"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ErrorMessage", "[", 
     RowBox[{"string1_", ",", "string2_", ",", 
      RowBox[{"{", 
       RowBox[{"r_", ",", "g_", ",", "b_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "string1", "]"}], "<>", "\"\< : \>\"", "<>", 
        
        RowBox[{"ToString", "[", "string2", "]"}]}], ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"r", ",", "g", ",", "b"}], "]"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NFindFile", "[", "filename_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "judge0", ",", " ", "judge1", ",", "judge2", ",", " ", "judge3", ",", 
        "out", ",", " ", "choice", ",", "readables", ",", " ", "existQ", ",", 
        " ", "existN", ",", " ", "existP", ",", " ", "alljudges", ",", " ", 
        "exist1", ",", "exist2", ",", "exist3", ",", " ", "exist4"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"judge0", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"ToString", "[", "filename", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"judge1", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"StringJoin", "[", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "filename", "]"}], ",", " ", 
           "\"\<.xls\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"judge2", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "filename", "]"}], ",", "\"\<.xlsx\>\""}],
           " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"judge3", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "filename", "]"}], ",", "\"\<.csv\>\""}], 
          " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"alljudges", "=", 
        RowBox[{"{", 
         RowBox[{"judge0", ",", "judge1", ",", "judge2", ",", "judge3"}], 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"existQ", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "=!=", "$Failed"}], "&"}], ",", " ", "alljudges"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"existN", "=", 
        RowBox[{"Count", "[", 
         RowBox[{"existQ", ",", " ", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"existP", "=", 
        RowBox[{"NPosition", "[", " ", 
         RowBox[{"existQ", ",", " ", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<choiceagain\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"existN", "===", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"readables", "=", "$Path"}], ";", " ", 
          RowBox[{"PB", "[", "]"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[FilledDiamond] The file `` was not found. \\n\\nCheck if \
`` is located in the following folders where Mathematica can read.:\\n\n$Path \
= ``\\n\\nThese paths can be identified by evaluating $Path.\>\"", ",", " ", 
               "filename", ",", " ", "filename", ",", " ", "readables"}], 
              "]"}], ",", "14"}], "]"}], "]"}], ";", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"out", "=", "$Failed"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"existN", "===", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"Part", "[", 
           RowBox[{"alljudges", ",", "  ", 
            RowBox[{"existP", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"existN", "===", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exist1", "=", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"exist2", "=", " ", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"choice", "=", " ", 
           RowBox[{"InputString", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<Two files were found:\\n`` and ``\\n Type 1 for ``, Type 2 \
for ``\\n\\nPress OK to choose ``\\nType end to quit\>\"", ",", 
               "\[IndentingNewLine]", "\t\t\t\t\t", "exist1", ",", "exist2", 
               ",", " ", "exist1", ",", " ", "exist2", ",", " ", "exist1"}], 
              "]"}], ",", " ", 
             RowBox[{"WindowMargins", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", " ", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "10"}], "}"}]}], "}"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"choice", "===", "\"\<1\>\""}], ",", 
            RowBox[{"out", "=", " ", "exist1"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<2\>\""}], ",", " ", 
            RowBox[{"out", "=", "exist2"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<\>\""}], ",", " ", 
            RowBox[{"out", " ", "=", " ", "exist1"}], ",", " ", 
            RowBox[{
             RowBox[{"choice", "===", "\"\<end\>\""}], "||", 
             RowBox[{"choice", "===", "\"\<quit\>\""}]}], ",", " ", 
            RowBox[{"Goto", "[", "\"\<datainending\>\"", "]"}], ",", "True", 
            ",", "  ", 
            RowBox[{
             RowBox[{"ErrorMessage", "[", "\"\<error\>\"", "]"}], ";", " ", 
             RowBox[{"Goto", "[", "\"\<choiceagain\>\"", "]"}]}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"existN", "===", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exist1", "=", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"exist2", "=", " ", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"exist3", "=", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"choice", "=", " ", 
           RowBox[{"InputString", "[", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Three files were found:\\n``, `` and ``\\n Type 1 for ``, \
Type 2 for ``, Type 3 for ``\\n\\nPress OK to choose ``\\nType end to \
quit\>\"", ",", "\[IndentingNewLine]", "\t\t\t\t\t", "exist1", ",", " ", 
              "exist2", ",", " ", "exist3", ",", " ", "exist1", ",", " ", 
              "exist2", ",", " ", "exist3"}], "  ", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"choice", "===", "\"\<1\>\""}], ",", 
            RowBox[{"out", "=", " ", "exist1"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<2\>\""}], ",", " ", 
            RowBox[{"out", "=", "exist2"}], ",", 
            RowBox[{"choice", "===", "\"\<3\>\""}], ",", " ", 
            RowBox[{"out", "=", "exist3"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<\>\""}], ",", " ", 
            RowBox[{"out", " ", "=", " ", "exist1"}], ",", 
            RowBox[{
             RowBox[{"choice", "===", "\"\<end\>\""}], "||", 
             RowBox[{"choice", "===", "\"\<quit\>\""}]}], ",", " ", 
            RowBox[{"Goto", "[", "\"\<datainending\>\"", "]"}], ",", " ", 
            "True", ",", "  ", 
            RowBox[{
             RowBox[{"ErrorMessage", "[", "\"\<error\>\"", "]"}], ";", " ", 
             RowBox[{"Goto", "[", "\"\<choiceagain\>\"", "]"}]}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"existN", "===", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exist1", "=", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"exist2", "=", " ", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"exist3", "=", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ";", 
          RowBox[{"exist4", "=", 
           RowBox[{"alljudges", "[", 
            RowBox[{"[", 
             RowBox[{"existP", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"choice", "=", " ", 
           RowBox[{"InputString", "[", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Four files were found:\\n``, ``, `` and ``\\n Type 1 for \
``, Type 2 for ``, Type 3 for ``, Type 4 for ``\\n\\nPress OK to choose \
``\\nType end to quit\>\"", ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
              "exist1", ",", " ", "exist2", ",", " ", "exist3", ",", "exist1",
               ",", " ", "exist1", ",", " ", "exist2", ",", " ", "exist3", 
              ",", "exist4"}], "  ", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"choice", "===", "\"\<1\>\""}], ",", 
            RowBox[{"out", "=", " ", "exist1"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<2\>\""}], ",", " ", 
            RowBox[{"out", "=", "exist2"}], ",", 
            RowBox[{"choice", "===", "\"\<3\>\""}], ",", " ", 
            RowBox[{"out", "=", "exist3"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<4\>\""}], ",", " ", 
            RowBox[{"out", "=", "exist4"}], ",", " ", 
            RowBox[{"choice", "===", "\"\<\>\""}], ",", " ", 
            RowBox[{"out", " ", "=", " ", "exist1"}], ",", 
            RowBox[{
             RowBox[{"choice", "===", "\"\<end\>\""}], "||", 
             RowBox[{"choice", "===", "\"\<quit\>\""}]}], ",", " ", 
            RowBox[{"Goto", "[", "\"\<datainending\>\"", "]"}], ",", "True", 
            ",", "  ", 
            RowBox[{
             RowBox[{"ErrorMessage", "[", "\"\<error\>\"", "]"}], ";", " ", 
             RowBox[{"Goto", "[", "\"\<choiceagain\>\"", "]"}]}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", " ", 
         
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<Unexpected choice error\>\"", "]"}], ";", 
          " ", 
          RowBox[{"Goto", "[", "\"\<choiceagain\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<datainending\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NFindFile3", "[", "filename_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "judge0", ",", " ", "judge11", ",", "judge2", ",", " ", "judge3", ",", 
        "out", ",", " ", "choice", ",", "readables", ",", " ", "existQ", ",", 
        " ", "existN", ",", " ", "existP", ",", " ", "alljudges", ",", " ", 
        "exist1", ",", "exist2", ",", "exist3", ",", " ", "exist4"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "NFindFile3", " ", "only", " ", "checks", " ", "if", " ", "the", " ", 
        "file", " ", "exits", " ", "or", " ", 
        RowBox[{"not", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"judge0", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"ToString", "[", "filename", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"judge11", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"StringJoin", "[", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "filename", "]"}], ",", " ", 
           "\"\<.xls\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"judge2", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "filename", "]"}], ",", "\"\<.xlsx\>\""}],
           " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"judge3", "=", 
        RowBox[{"FindFile", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "filename", "]"}], ",", "\"\<.csv\>\""}], 
          " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"alljudges", "=", 
        RowBox[{"{", 
         RowBox[{"judge0", ",", "judge11", ",", "judge2", ",", "judge3"}], 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"existQ", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "=!=", "$Failed"}], "&"}], ",", " ", "alljudges"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"existN", "=", 
        RowBox[{"Count", "[", 
         RowBox[{"existQ", ",", " ", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"existP", "=", 
        RowBox[{"NPosition", "[", " ", 
         RowBox[{"existQ", ",", " ", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"existN", "===", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"readables", "=", "$Path"}], ";", " ", 
          RowBox[{"PB", "[", "]"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[FilledDiamond] The file `` was not found. \\n\\nCheck if \
`` is located in the following folders where Mathematica can read.:\\n\n$Path \
= ``\\n\\nThese paths can be identified by evaluating $Path.\>\"", ",", " ", 
               "filename", ",", " ", "filename", ",", " ", "readables"}], 
              "]"}], ",", "14"}], "]"}], "]"}], ";", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"out", "=", "False"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"existN", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", "True"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<Unexpected choice error\>\"", "]"}], ";", 
          " ", 
          RowBox[{"out", " ", "=", " ", "False"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "out"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntactComplement", "[", 
     RowBox[{
      RowBox[{"list_", "?", "ListQ"}], ",", 
      RowBox[{"omit_", "?", "ListQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nlist", ",", " ", "gathered", ",", " ", "len", ",", "k"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nlist", " ", "=", " ", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{"MemberQ", "[", " ", 
              RowBox[{"omit", ",", " ", "#"}], "]"}], ",", " ", "Null", ",", 
             " ", "#", ",", " ", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Message", "[", 
              RowBox[{"IntactComplement", "::", "badarg"}], "]"}]}], " ", 
            "]"}], "&"}], ",", " ", "list"}], " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gathered", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"len", " ", "=", " ", 
        RowBox[{"Length", "[", "nlist", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", " ", 
        RowBox[{
         RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"k", " ", "\[LessEqual]", " ", "len"}], ",", " ", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"nlist", " ", "[", 
             RowBox[{"[", "k", "]"}], "]"}], " ", "=!=", " ", "Null"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"gathered", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"gathered", ",", " ", 
              RowBox[{"nlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}]}]}], " ", "]"}]}],
         "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
       "gathered"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntactComplement", "::", "badarg"}], "=", 
    "\"\<Unexpected data error\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cleandata", "[", 
     RowBox[{"list_", "?", "ListQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "f", ",", " ", "ele", ",", " ", "g", ",", " ", "tag", ",", " ", 
        "nvectorq", ",", "check", ",", " ", "periodcleaner"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nvectorq", "[", "ele_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ele", "]"}], "\[GreaterEqual]", " ", "3"}], 
         " ", "&&", " ", 
         RowBox[{"VectorQ", "[", "ele", "]"}], "&&", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"NumberQ", ",", " ", "ele"}], "]"}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"ele_", ",", " ", "tag_"}], "]"}], ":=", " ", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<{\>\"", ",", " ", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "ele", "]"}], ",", " ", 
             RowBox[{"tag", " ", "\[Rule]", " ", "\"\<,\>\""}]}], "]"}], ",", 
           " ", "\"\<}\>\""}], " ", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"check", "[", "ele_", "]"}], ":=", " ", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"ele", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<[\>\"", " ", "\[Rule]", " ", "\"\<{\>\""}], ",", " ", 
            RowBox[{"\"\<]\>\"", " ", "\[Rule]", " ", "\"\<}\>\""}], ",", " ", 
            RowBox[{"\"\< \>\"", " ", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"periodcleaner", "[", "ele_", "]"}], ":=", " ", 
        RowBox[{"StringReplace", "[", " ", 
         RowBox[{"ele", ",", " ", 
          RowBox[{"\"\<.\>\"", "\[Rule]", " ", "\"\<,\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", "ele_", "]"}], ":=", " ", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", " ", 
         RowBox[{
          RowBox[{"ele", "===", "Null"}], ",", "Null", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ele", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ele", "===", "\"\<\>\""}], ",", " ", "Null", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ele", "===", "\"\< \>\""}], ",", " ", "Null", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ele", "===", "\"\<\:3000\>\""}], ",", " ", "Null", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ele", "===", "\"\<Null\>\""}], ",", " ", "Null", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DateObjectQ", "[", "ele", "]"}], ",", " ", 
          RowBox[{"ele", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerPart", "[", "ele", "]"}], "-", "ele"}], "===", 
           "0."}], ",", 
          RowBox[{"IntegerPart", "[", "ele", "]"}], ",", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"RealVectorQ", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<{\>\"", ",", " ", 
               RowBox[{"ToString", "[", "ele", "]"}], ",", " ", "\"\<}\>\""}],
               "]"}], "]"}], ",", "3"}], "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ToExpression", "[", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<{\>\"", ",", " ", 
             RowBox[{"ToString", "[", "ele", "]"}], ",", " ", "\"\<}\>\""}], 
            "]"}], " ", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"LetterQ", "[", 
           RowBox[{"ToString", "[", "ele", "]"}], "]"}], ",", " ", 
          RowBox[{"ToExpression", "[", "ele", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"NumberQ", "[", "ele", "]"}], ",", "ele", ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringQ", "[", "ele", "]"}], "&&", 
           RowBox[{"NumberQ", "[", 
            RowBox[{"ToExpression", "[", "ele", "]"}], "]"}]}], ",", 
          RowBox[{"ToExpression", "[", "ele", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringQ", "[", "ele", "]"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"ToExpression", "[", "ele", "]"}], "]"}], "===", "0"}]}],
           ",", "\[IndentingNewLine]", "ele", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringQ", "[", "ele", "]"}], "&&", 
           RowBox[{"RealVectorQ", "[", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"check", "[", "ele", "]"}], "]"}], ",", "3"}], "]"}]}], 
          ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"check", "[", "ele", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringQ", "[", "ele", "]"}], "&&", 
           RowBox[{"RealVectorQ", "[", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"periodcleaner", "[", "ele", "]"}], "]"}], ",", "3"}], 
            "]"}]}], ",", " ", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"periodcleaner", "[", "ele", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"nvectorq", "[", 
           RowBox[{"g", "[", 
            RowBox[{"ele", ",", " ", "\"\<.\>\""}], "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"ele", ",", " ", "\"\<.\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringQ", "[", "ele", "]"}], "&&", " ", 
           RowBox[{"NumberQ", "[", 
            RowBox[{"g", "[", 
             RowBox[{"ele", ",", " ", "\"\<.\>\""}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"g", "[", 
           RowBox[{"ele", ",", " ", "\"\<,\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"nvectorq", "[", 
           RowBox[{"g", "[", 
            RowBox[{"ele", ",", " ", "\"\</\>\""}], "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"ele", ",", " ", "\"\</\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"RealVectorQ", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "ele", "]"}], ",", " ", "\"\<}\>\""}],
               "]"}], "]"}], ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "ele", "]"}], ",", " ", "\"\<}\>\""}], 
            "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"RealVectorQ", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<{\>\"", ",", 
               RowBox[{"ToString", "[", "ele", "]"}]}], "]"}], "]"}], ",", 
            "3"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<{\>\"", ",", 
             RowBox[{"ToString", "[", "ele", "]"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "ele", "]"}], "===", "6"}], "&&", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Drop", "[", 
              RowBox[{"ele", ",", "3"}], "]"}], "]"}], "\[Equal]", "0"}]}], 
          ",", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"ele", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"ToExpression", "[", "ele", "]"}], "]"}], "===", "6"}], "&&", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Drop", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "ele", "]"}], ",", "3"}], "]"}], 
             "]"}], "\[Equal]", "0"}]}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", "ele", "]"}], ",", "3"}], "]"}], ",",
           "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
          RowBox[{"ToExpression", "[", "ele", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", " ", "list", ",", " ", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExportExcel", "[", 
     RowBox[{"filebody_", ",", "filehead_", ",", "excelname_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fdim", ",", " ", "rownumb", ",", " ", "eei", ",", " ", "eecount", ",",
         " ", "denovoname", ",", "eefulldata", ",", " ", "current"}], "}"}], 
      ",", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"filebody", ":", " ", "\:30c7\:30fc\:30bf\:672c\:4f53"}], 
        "\:3001", 
        RowBox[{"filehead", ":", " ", "\:9805\:76ee\:540d"}], "\:3001", 
        RowBox[{
        "excename", ":", " ", 
         "\:51fa\:529b\:30d5\:30a1\:30a4\:30eb\:306e\:540d\:79f0"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:51fa\:529b\:30d5\:30a1\:30a4\:30eb\:306e\:540d\:79f0\:306f", " ", 
         "excelname"}], " ", "+", " ", "No", " ", "+", " ", "integer", " ", 
        "+", " ", "Date", " ", "+", " ", 
        RowBox[{
         RowBox[{"\:5e74\:6708\:65e5", ".", "xlsx"}], " ", 
         "\:3068\:306a\:308b"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
      "(*", " ", 
       "\:5217\:306e\:6570\:306f200\:4ee5\:4e0b\:305a\:3064\:306b\:306a\:308b\
", " ", "*)"}], "\n", "\n", 
      RowBox[{
       RowBox[{"fdim", "=", 
        RowBox[{"Dimensions", "[", "filebody", "]"}]}], ";", 
       RowBox[{"Global`EEFDIM", "=", "fdim"}], ";", "\n", 
       RowBox[{"Which", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"ListQ", "[", "filebody", "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The body of data was not a list.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"ListQ", "[", "filehead", "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The head of data was not a list.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"fdim", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=!=", 
          RowBox[{"Length", "[", "filehead", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The column nmber of the body of data was not equal to the \
length of the head of the data.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], "\n", "]"}], 
       ";", "\n", "\n", 
       RowBox[{"rownumb", "=", 
        RowBox[{"fdim", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"eecount", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"rownumb", "/", "200"}], "]"}]}], ";", "\n", 
       RowBox[{"Global`ROWNUMB", "=", "rownumb"}], ";", " ", 
       RowBox[{"Global`EECOUNT", "=", "eecount"}], ";", "\n", 
       RowBox[{"eefulldata", "=", 
        RowBox[{"JoinDataItems", "[", 
         RowBox[{"filebody", ",", " ", "filehead"}], "]"}]}], ";", 
       RowBox[{"Global`EEFULLDATA", "=", "eefulldata"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"current", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\n", "\n", 
       RowBox[{"Which", "[", " ", 
        RowBox[{
         RowBox[{"eecount", "===", "1"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"current", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"\"\<No\>\"", ",", 
                    RowBox[{"ToString", "@", "eei"}], ","}], "*)"}], " ", 
                  "\"\<Date\>\"", ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"200", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"200", " ", "eei"}], ",", " ", "rownumb"}], "  ", 
                    "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\n", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the home directory: ``\\nwith the following name: ``\>\"", ",", " ", 
                 "$HomeDirectory", ",", 
                 RowBox[{"denovoname", "[", "1", "]"}]}], "]"}], ",", "15", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetDirectory", "[", 
             RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"\"\<No\>\"", ",", 
                    RowBox[{"ToString", "@", "eei"}], ","}], " ", "*)"}], 
                  "\"\<Date\>\"", ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"200", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"200", " ", "eei"}], ",", " ", "rownumb"}], "  ", 
                    "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the current directory: ``\\nin `` files with the following names: ``\>\"", 
                 ",", " ", 
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", "eecount", ",", 
                 RowBox[{"denovoname", "[", "1", "]"}]}], "]"}], ",", "15", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"SetDirectory", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ErrorMessage", "[", "\"\<Unexpected Export Error\>\"", "]"}], 
            ";", 
            RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\n", "\n", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "eecount", "]"}], "&&", 
          RowBox[{"eecount", ">=", " ", "2"}]}], ",", "\[IndentingNewLine]", 
         "\n", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"current", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  "\"\<No\>\"", ",", 
                  RowBox[{"ToString", "@", "eei"}], ",", " ", "\"\<Date\>\"", 
                  ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"200", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"200", " ", "eei"}], ",", " ", "rownumb"}], "  ", 
                    "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the home directory: ``\\nin `` files with the following names: ``\>\"", 
                 ",", " ", "$HomeDirectory", ",", "eecount", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"eei", ",", "1", ",", "eecount"}], "}"}]}], 
                  "]"}]}], "]"}], ",", "15", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetDirectory", "[", 
             RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  "\"\<No\>\"", ",", 
                  RowBox[{"ToString", "@", "eei"}], ",", " ", "\"\<Date\>\"", 
                  ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"200", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"200", " ", "eei"}], ",", " ", "rownumb"}], "  ", 
                    "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the current directory: ``\\nin `` files with the following names: ``\>\"", 
                 ",", " ", 
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", "eecount", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"eei", ",", "1", ",", "eecount"}], "}"}]}], 
                  "]"}]}], "]"}], ",", "15", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"SetDirectory", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ErrorMessage", "[", "\"\<Unexpected Export Error\>\"", "]"}], 
            ";", 
            RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", "\n", 
         "\n", "True", ",", " ", 
         RowBox[{
         "ErrorMessage", "[", 
          "\"\<The data was not exported for an unknow reasons\>\"", "]"}]}], 
        "\n", "]"}], ";", "\n", "\n", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<EEending\>\"", "]"}], ";"}]}], "\n", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExportExcel2", "[", 
     RowBox[{"filebody_", ",", "filehead_", ",", "excelname_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fdim", ",", " ", "rownumb", ",", " ", "eei", ",", " ", "eecount", ",",
         " ", "denovoname", ",", "eefulldata", ",", "mleng", ",", " ", 
        "current"}], "}"}], ",", "\n", "\[IndentingNewLine]", 
      RowBox[{
      "(*", " ", 
       "\:5217\:306e\:6570\:30921200\:4ee5\:4e0b\:306b\:3057\:305f\:3082\:306e\
", " ", "*)"}], "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"filebody", ":", " ", "\:30c7\:30fc\:30bf\:672c\:4f53"}], 
        "\:3001", 
        RowBox[{"filehead", ":", " ", "\:9805\:76ee\:540d"}], "\:3001", 
        RowBox[{
        "excename", ":", " ", 
         "\:51fa\:529b\:30d5\:30a1\:30a4\:30eb\:306e\:540d\:79f0"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:51fa\:529b\:30d5\:30a1\:30a4\:30eb\:306e\:540d\:79f0\:306f", " ", 
         "excelname"}], " ", "+", " ", "No", " ", "+", " ", "integer", " ", 
        "+", " ", "Date", " ", "+", " ", 
        RowBox[{
         RowBox[{"\:5e74\:6708\:65e5", ".", "xlsx"}], " ", 
         "\:3068\:306a\:308b"}]}], " ", "*)"}], "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mleng", "=", "1200"}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "mleng", ":", " ", 
         "\:4e00\:3064\:306eExcel\:306e\:5217\:306e\:9577\:3055\:306e\:6700\
\:5927"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
       RowBox[{"fdim", "=", 
        RowBox[{"Dimensions", "[", "filebody", "]"}]}], ";", 
       RowBox[{"Global`EEFDIM", "=", "fdim"}], ";", "\n", 
       RowBox[{"Which", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"ListQ", "[", "filebody", "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The body of data was not a list.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"ListQ", "[", "filehead", "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The head of data was not a list.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"fdim", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=!=", 
          RowBox[{"Length", "[", "filehead", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The column nmber of the body of data was not equal to the \
length of the head of the data.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], "\n", "]"}], 
       ";", "\n", "\n", 
       RowBox[{"rownumb", "=", 
        RowBox[{"fdim", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"eecount", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"rownumb", "/", "mleng"}], "]"}]}], ";", "\n", 
       RowBox[{"Global`ROWNUMB", "=", "rownumb"}], ";", " ", 
       RowBox[{"Global`EECOUNT", "=", "eecount"}], ";", "\n", 
       RowBox[{"eefulldata", "=", 
        RowBox[{"JoinDataItems", "[", 
         RowBox[{"filebody", ",", " ", "filehead"}], "]"}]}], ";", 
       RowBox[{"Global`EEFULLDATA", "=", "eefulldata"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"current", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Which", "[", " ", 
        RowBox[{
         RowBox[{"eecount", "===", "1"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"current", "===", "$Failed"}], ",", "\n", "\n", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"\"\<No\>\"", ",", 
                    RowBox[{"ToString", "@", "eei"}], ","}], "*)"}], " ", 
                  "\"\<Date\>\"", ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\n", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the home directory: ``\\nwith the following name: ``\>\"", ",", " ", 
                 "$HomeDirectory", ",", 
                 RowBox[{"denovoname", "[", "1", "]"}]}], "]"}], ",", "15", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}]}], ",", "\n", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetDirectory", "[", 
             RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"\"\<No\>\"", ",", 
                    RowBox[{"ToString", "@", "eei"}], ","}], " ", "*)"}], 
                  "\"\<Date\>\"", ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the current directory: ``\\nwith the following name: ``\>\"", ",", " ", 
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 RowBox[{"denovoname", "[", "1", "]"}]}], "]"}], ",", "15", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"SetDirectory", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ErrorMessage", "[", "\"\<Unexpected Export Error\>\"", "]"}], 
            ";", 
            RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "\n", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "eecount", "]"}], "&&", 
          RowBox[{"eecount", ">=", " ", "2"}]}], ",", "\n", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"current", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  "\"\<No\>\"", ",", 
                  RowBox[{"ToString", "@", "eei"}], ",", " ", "\"\<Date\>\"", 
                  ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\n", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the home directory: ``\\nin `` files with the following names: ``\>\"", 
                 ",", " ", "eecount", ",", "$HomeDirectory", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"eei", ",", "1", ",", "eecount"}], "}"}]}], 
                  "]"}]}], "]"}], ",", "15", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}]}], ",", "\n", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetDirectory", "[", 
             RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  "\"\<No\>\"", ",", 
                  RowBox[{"ToString", "@", "eei"}], ",", " ", "\"\<Date\>\"", 
                  ",", " ", "PresentTime", ",", 
                  RowBox[{"ToString", "[", "eei", "]"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the current directory: ``\\nwith the following name: ``\>\"", ",", " ", 
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"eei", ",", "1", ",", "eecount"}], "}"}]}], 
                  "]"}]}], "]"}], ",", "15", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"SetDirectory", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ErrorMessage", "[", "\"\<Unexpected Export Error\>\"", "]"}], 
            ";", 
            RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "\n", 
         "True", ",", " ", 
         RowBox[{
         "ErrorMessage", "[", 
          "\"\<The data was not exported for an unknow reasons\>\"", "]"}]}], 
        "\n", "]"}], ";", "\n", "\n", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<EEending\>\"", "]"}], ";"}]}], "\n", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExportExcel3", "[", 
     RowBox[{"filebody_", ",", "filehead_", ",", "excelname_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fdim", ",", " ", "rownumb", ",", " ", "eei", ",", " ", "eecount", ",",
         " ", "denovoname", ",", "eefulldata", ",", "mleng", ",", " ", 
        "current"}], "}"}], ",", "\n", "\[IndentingNewLine]", 
      RowBox[{
      "(*", " ", 
       "\:5217\:306e\:6570\:30921200\:4ee5\:4e0b\:306b\:3057\:305f\:3082\:306e\
", " ", "*)"}], "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"filebody", ":", " ", "\:30c7\:30fc\:30bf\:672c\:4f53"}], 
        "\:3001", 
        RowBox[{"filehead", ":", " ", "\:9805\:76ee\:540d"}], "\:3001", 
        RowBox[{"excename", ":", " ", 
         RowBox[{"\:51fa\:529b\:30d5\:30a1\:30a4\:30eb\:306e\:540d\:79f0", 
          RowBox[{"(", 
           RowBox[{
           "\:3053\:308c\:306b\:306f", ".", 
            "xlsx\:306f\:3064\:3051\:306a\:3044"}], ")"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:51fa\:529b\:30d5\:30a1\:30a4\:30eb\:306e\:540d\:79f0\:306f", " ", 
         RowBox[{"excelname", ".", "xlsx"}], " ", "\:3068\:306a\:308b"}], 
        "\:3002", "\:5e74\:6708\:65e5\:306f\:3064\:304b\:306a\:3044", 
        "\:3002"}], " ", "*)"}], "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mleng", "=", "1200"}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "mleng", ":", " ", 
         "\:4e00\:3064\:306eExcel\:306e\:5217\:306e\:9577\:3055\:306e\:6700\
\:5927"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
       RowBox[{"fdim", "=", 
        RowBox[{"Dimensions", "[", "filebody", "]"}]}], ";", 
       RowBox[{"Global`EEFDIM", "=", "fdim"}], ";", "\n", 
       RowBox[{"Which", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"ListQ", "[", "filebody", "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The body of data was not a list.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"ListQ", "[", "filehead", "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The head of data was not a list.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"fdim", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=!=", 
          RowBox[{"Length", "[", "filehead", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The column nmber of the body of data was not equal to the \
length of the head of the data.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], "\n", "]"}], 
       ";", "\n", "\n", 
       RowBox[{"rownumb", "=", 
        RowBox[{"fdim", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"eecount", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"rownumb", "/", "mleng"}], "]"}]}], ";", "\n", 
       RowBox[{"Global`ROWNUMB", "=", "rownumb"}], ";", " ", 
       RowBox[{"Global`EECOUNT", "=", "eecount"}], ";", "\n", 
       RowBox[{"eefulldata", "=", 
        RowBox[{"JoinDataItems", "[", 
         RowBox[{"filebody", ",", " ", "filehead"}], "]"}]}], ";", 
       RowBox[{"Global`EEFULLDATA", "=", "eefulldata"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"current", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Which", "[", " ", 
        RowBox[{
         RowBox[{"eecount", "===", "1"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"current", "===", "$Failed"}], ",", "\n", "\n", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"\"\<No\>\"", ",", " ", 
                    RowBox[{"ToString", "@", "eei"}], ","}], "*)"}], " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\n", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the home directory: ``\\nwith the following name: ``\>\"", ",", " ", 
                 "$HomeDirectory", ",", 
                 RowBox[{"denovoname", "[", "1", "]"}]}], "]"}], ",", "15", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}]}], ",", "\n", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetDirectory", "[", 
             RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"\"\<No\>\"", ",", " ", 
                    RowBox[{"ToString", "@", "eei"}], ","}], "*)"}], " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the current directory: ``\\nwith the following name: ``\>\"", ",", " ", 
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 RowBox[{"denovoname", "[", "1", "]"}]}], "]"}], ",", "15", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"SetDirectory", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ErrorMessage", "[", "\"\<Unexpected Export Error\>\"", "]"}], 
            ";", 
            RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\n", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "eecount", "]"}], "&&", 
          RowBox[{"eecount", ">=", " ", "2"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"current", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", " ", 
                  "\"\<No\>\"", ",", " ", 
                  RowBox[{"ToString", "@", "eei"}], ",", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\n", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the home directory: ``\\nin `` files with the following names: ``\>\"", 
                 ",", " ", "$HomeDirectory", ",", "eecount", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"eei", ",", "1", ",", "eecount"}], "}"}]}], 
                  "]"}]}], "]"}], ",", "15", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetDirectory", "[", 
             RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"eei", "=", "1"}], ",", " ", 
              RowBox[{"eei", "<=", " ", "eecount"}], ",", " ", 
              RowBox[{"eei", "++"}], ",", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"denovoname", "[", "eei", "]"}], "=", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "excelname", "]"}], ",", 
                  "\"\<No\>\"", ",", " ", 
                  RowBox[{"ToString", "@", "eei"}], ",", " ", " ", 
                  "\"\<.xlsx\>\""}], "]"}]}], ";", "\n", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                 RowBox[{"eefulldata", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"mleng", 
                    RowBox[{"(", 
                    RowBox[{"eei", "-", "1"}], ")"}]}]}], ",", " ", 
                    RowBox[{"NMin", "[", 
                    RowBox[{
                    RowBox[{"mleng", "*", "eei"}], ",", " ", "rownumb"}], 
                    "  ", "]"}]}], "  ", "]"}]}], " ", "]"}], "]"}]}], " ", 
                "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<\[FilledDiamond] The data in the analysis was exported \
in the current directory: ``\\nin `` files with the following names: ``\>\"", 
                 ",", " ", 
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", "eecount", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"denovoname", "[", "eei", "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"eei", ",", "1", ",", "eecount"}], "}"}]}], 
                  "]"}]}], "]"}], ",", "15", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{
                "0.00709545", ",", " ", "0.646342", ",", " ", "0.0588235"}], 
                "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"SetDirectory", "[", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ErrorMessage", "[", "\"\<Unexpected Export Error\>\"", "]"}], 
            ";", 
            RowBox[{"Goto", "[", "\"\<EEending\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\n", "\n", "True", ",", " ", 
         RowBox[{
         "ErrorMessage", "[", 
          "\"\<The data was not exported for an unknow reasons\>\"", "]"}]}], 
        "\n", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<EEending\>\"", "]"}], ";"}]}], "\n", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListNormalize", "[", 
     RowBox[{"databody_", ",", " ", "dataheads_"}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nullchecker", ",", " ", "bmlist0", ",", " ", "bmitems0", ",", " ", 
        "elems", ",", " ", "databody2", ",", " ", "dataheads2", ",", " ", 
        "databody3", ",", " ", "dataheads3"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ListQ", "@", "databody"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Depth", "@", "databody"}], "===", "3"}], ")"}]}], 
           ")"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The first augment is inappropriate.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<liststandending\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ListQ", "@", "dataheads"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Depth", "@", "dataheads"}], "===", "3"}], ")"}]}], 
           ")"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The second augment is inappropriate.\>\"",
            "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<liststandending\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "databody", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=!=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "dataheads", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The column count of the body of data must be equal to the row \
count of the heads of data.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<liststandending\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Null", " ", "Checker"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"nullchecker", "[", 
         RowBox[{"bmlist0_", ",", " ", "bmitems0_"}], "]"}], ":=", 
        RowBox[{"Module", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "nclen", ",", " ", "ji", ",", " ", "nbag", ",", " ", "nline", ",", 
            " ", "nlout", ",", " ", "nljudge", ",", " ", "allmeans", ",", " ",
             "address1", ",", " ", "func", ",", " ", "bpos", ",", " ", 
            "bmean", ",", " ", "rules1", ",", " ", "realpos", ",", " ", 
            "allmedians", ",", " ", "address2", ",", " ", "rules2", ",", " ", 
            "ncleng", ",", " ", "mbag", ",", " ", "mline", ",", "realrow", 
            ",", " ", "emptyrow", ",", " ", "emptyitems", ",", " ", "bmlist", 
            ",", " ", "bmitems"}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nbag", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"mbag", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"func", "[", 
             RowBox[{"bpos_", ",", "bmean_"}], "]"}], ":=", 
            RowBox[{"{", 
             RowBox[{"bpos", "\[Rule]", " ", 
              RowBox[{"bmean", "[", 
               RowBox[{"[", 
                RowBox[{"bpos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Global`BMLIST0", "=", "bmlist0"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"ncleng", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"Transpose", "[", "bmlist0", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
           "(*", " ", "\:7a7a\:306e\:5217\:306e\:51e6\:7406", " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"ji", "=", "1"}], ",", " ", 
             RowBox[{"ji", "\[LessEqual]", " ", "ncleng"}], ",", " ", 
             RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"mline", "=", 
               RowBox[{
                RowBox[{"Transpose", "[", "bmlist0", "]"}], "[", 
                RowBox[{"[", "ji", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"mbag", ",", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"NumberQ", ",", " ", "mline"}], "]"}], "]"}], "===", 
                   RowBox[{"{", "False", "}"}]}], ",", " ", "1", ",", " ", 
                  "0", ",", " ", "0"}], "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"mbag", ",", " ", "1"}], "]"}], "===", "False"}], ",", 
             " ", 
             RowBox[{
              RowBox[{"bmlist", "=", "bmlist0"}], ";", " ", 
              RowBox[{"bmitems", "=", "bmitems0"}], ";", 
              RowBox[{"Goto", "[", "\"\<nextphase\>\"", "]"}]}]}], "]"}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"realrow", "=", 
            RowBox[{"NPosition", "[", 
             RowBox[{"mbag", ",", " ", "0"}], "]"}]}], ";", " ", 
           RowBox[{"emptyrow", "=", 
            RowBox[{"NPosition", "[", 
             RowBox[{"mbag", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"bmlist", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "bmlist0", "]"}], ",", " ", 
               "realrow"}], "]"}], "]"}]}], ";", 
           RowBox[{"interlist", "=", "bmlist"}], ";", "\[IndentingNewLine]", 
           RowBox[{"bmitems", "=", 
            RowBox[{"Part", "[", " ", 
             RowBox[{"bmitems0", ",", " ", "realrow"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"emptyitems", "=", 
            RowBox[{"MakeTwin", "[", 
             RowBox[{"emptyrow", ",", 
              RowBox[{"Part", "[", " ", 
               RowBox[{"bmitems0", ",", " ", "emptyrow"}], "]"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<\[EmptyDiamond] Completely empty or non-numeric rows were \
excluded.\\n  Their row numbers and item names are ``.\>\"", ",", " ", 
                "emptyitems"}], "]"}], ",", " ", "Bold", ",", " ", "15", ",", 
              " ", "Red"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<                                                    \>\"", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Label", "[", "\"\<nextphase\>\"", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nclen", "=", 
            RowBox[{"Length", "[", "bmlist", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nlout", "=", 
            RowBox[{"{", 
             RowBox[{"bmlist", ",", "bmitems"}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
           "(*", " ", "\:7a7a\:306e\:30bb\:30eb\:306e\:51e6\:7406", " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"For", "[", " ", 
            RowBox[{
             RowBox[{"ji", "=", "1"}], ",", " ", 
             RowBox[{"ji", "\[LessEqual]", " ", "nclen"}], ",", " ", 
             RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nline", "=", 
               RowBox[{"bmlist", "[", 
                RowBox[{"[", "ji", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"nbag", ",", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"NumberQ", ",", " ", "nline"}], "]"}], "]"}], "===", 
                   RowBox[{"{", "True", "}"}]}], ",", " ", "0", ",", " ", "1",
                   ",", " ", "1"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"nbag", ",", " ", "1"}], "]"}], "===", "False"}], ",", 
             "  ", 
             RowBox[{"Goto", "[", "\"\<ncending\>\"", "]"}]}], "]"}], ";", 
           RowBox[{"Global`NBAG", "=", "nbag"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Global`BMLIST", "=", "bmlist"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Label", "[", "\"\<nljudgeagain\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nljudge", "=", 
            RowBox[{"InputString", "[", 
             RowBox[{
             "\"\<Some columns contain non-numeric cells.\\nPress OK to \
replace empty cell with median value of the row.\\n\\nType a to replace empty \
cell with average value of the row.\\nType n to leave empty cells as they \
are.\\nType x to excluede those columns.\\nType end to quit.\>\"", ",", " ", 
              RowBox[{"WindowMargins", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "10"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", " ", "10"}], "}"}]}], "}"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"allmeans", "=", 
            RowBox[{"Map", "[", " ", 
             RowBox[{"NMean", ",", " ", 
              RowBox[{"Transpose", "[", "bmlist", "]"}]}], "]"}]}], ";", 
           RowBox[{"Global`ALLMEANS", "=", "allmeans"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"allmedians", "=", 
            RowBox[{"Map", "[", " ", 
             RowBox[{"NMedian", ",", " ", 
              RowBox[{"Transpose", "[", "bmlist", "]"}]}], "]"}]}], ";", 
           RowBox[{"Global`ALLMEDIANS", "=", "allmedians"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"nljudge", "===", "\"\<end\>\""}], "||", 
              RowBox[{"nljudge", "===", "\"\<end\>\""}]}], ",", " ", 
             RowBox[{
              RowBox[{"nlout", "=", "\"\<terminated\>\""}], ";", 
              RowBox[{"Goto", "[", "\"\<ncending\>\"", "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"nljudge", "===", "\"\<x\>\""}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"realpos", "=", 
               RowBox[{"NPosition", "[", 
                RowBox[{"nbag", ",", " ", "0"}], "]"}]}], ";", 
              RowBox[{"Global`REALPOS", "=", "realpos"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nlout", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"bmlist", ",", " ", "realpos"}], "]"}], ",", 
                 "bmitems"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Columns that contain non-numeric cells were \
excluded.\>\"", ",", "15", ",", " ", "Purple", ",", " ", "Bold"}], "]"}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<\[EmptyDiamond] Initial N of columns = ``, Final N of \
columns = ``\>\"", ",", " ", "nclen", ",", " ", 
                   RowBox[{"Length", "[", 
                    RowBox[{"nlout", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", " ", 
                 "15", ",", "Bold"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<                                           \>\"", "]"}]}],
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nljudge", "===", "\"\<a\>\""}], "&&", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"NumberQ", ",", " ", "allmeans"}], "]"}], "]"}], "===", 
               RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"address1", "=", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"NumberQ", ",", " ", "bmlist", ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", "False"}], 
                "]"}]}], ";", 
              RowBox[{"Global`ADDRESS1", "=", "address1"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"rules1", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Map", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"func", "[", 
                    RowBox[{"#", ",", "allmeans"}], " ", "]"}], "&"}], ",", 
                   " ", "address1"}], "]"}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"Global`RULES1", "=", "rules1"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nlout", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"bmlist", ",", " ", "rules1"}], "]"}], ",", 
                 "bmitems"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\[EmptyDiamond] Non-numeric cells were replaced with \
average values of the row.\>\"", ",", " ", "15", ",", "Purple", ",", " ", 
                 "Bold"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<                                           \>\"", "]"}]}],
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nljudge", "===", "\"\<\>\""}], "&&", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"NumberQ", ",", " ", "allmedians"}], "]"}], "]"}], "===", 
               RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"address2", "=", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"NumberQ", ",", " ", "bmlist", ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", "False"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"rules2", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Map", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"func", "[", 
                    RowBox[{"#", ",", "allmedians"}], "]"}], "&"}], ",", " ", 
                   "address2"}], "]"}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nlout", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"bmlist", ",", " ", "rules2"}], "]"}], ",", 
                 "bmitems"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\[EmptyDiamond] Non-numeric cells were replaced with \
median values of the row.\>\"", ",", "15", ",", " ", "Purple", ",", " ", 
                 "Bold"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<                                           \>\"", "]"}]}],
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"nljudge", "===", "\"\<n\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\[EmptyDiamond] Empty cells were left unchanged.\>\"", 
                 ",", "15", ",", "Bold"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<                                           \>\"", "]"}], 
              ";", 
              RowBox[{"Goto", "[", "\"\<ncending\>\"", "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nljudge", "===", "\"\<a\>\""}], "&&", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"NumberQ", ",", " ", "allmeans"}], "]"}], "]"}], "=!=", 
               RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ErrorMessage", "[", 
               RowBox[{
               "\"\<Type in again, because some rows have no numeric value.\>\
\"", ",", "15", ",", " ", "Purple", ",", " ", "Bold"}], "]"}], ";", 
              RowBox[{"Goto", "[", "\"\<nljudgeagain\>\"", "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nljudge", "===", "\"\<\>\""}], "&&", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"NumberQ", ",", " ", "allmedians"}], "]"}], "]"}], "=!=", 
               RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "ErrorMessage", "[", 
               "\"\<Type in again, because some rows have no numeric value.\>\
\"", "]"}], ";", 
              RowBox[{"Goto", "[", "\"\<nljudgeagain\>\"", "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ErrorMessage", "[", "\"\<Type in, again.\>\"", "]"}], 
              ";", 
              RowBox[{"Goto", "[", "\"\<nljudgeagain\>\"", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Label", "[", "\"\<ncending\>\"", "]"}], ";", 
           "\[IndentingNewLine]", "nlout"}]}], "\[IndentingNewLine]", "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Map", "[", " ", 
            RowBox[{"NumericQ", ",", " ", 
             RowBox[{"Flatten", "@", "databody"}]}], " ", "]"}], "]"}], "=!=", 
          RowBox[{"{", "True", "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<                                        \>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{
             "StringForm", "[", 
              "\"\<\[FilledSquare] The data must be EMPTY CELL FREE for \
Normalization.\\nINTERPOLATE the empty cells, first.\>\"", "]"}], ",", " ", 
             "Bold", ",", " ", "Red", ",", " ", "15"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                        \>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"databody2", ",", " ", "dataheads2"}], "}"}], "=", 
           RowBox[{"nullchecker", "[", 
            RowBox[{"databody", ",", "dataheads"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"databody2", ",", " ", "dataheads2"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{"databody", ",", " ", "dataheads"}], "}"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "         ", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Global`DATABODY2", "=", "databody2"}], ";", " ", 
       RowBox[{"Global`DATAHEADS2", "=", "dataheads2"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"databody3", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Map", "[", 
           RowBox[{"Rescale", ",", " ", 
            RowBox[{"Transpose", "@", "databody2"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataheads3", "=", "dataheads2"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<liststandending\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Global`DATABODY", "=", "databody3"}], ";", " ", 
       RowBox[{"Global`DATAHEADS", "=", "dataheads3"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"databody3", ",", " ", "dataheads3"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NRandomSample", "[", 
     RowBox[{"vec_", ",", " ", "int_", ",", " ", 
      RowBox[{"seed_", ":", "Null"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\:6574\:6570\:306e\:30d9\:30af\:30c8\:30eb\:3067\:3042\:308bvec\:304b\
\:3089", "\:3001", 
        "\:91cd\:8907\:3092\:8a31\:3055\:305aint\:306e\:6570\:306e\:9806\:5217\
\:3092\:30e9\:30f3\:30c0\:30e0\:306b\:4f5c\:308a\:51fa\:3059"}], " ", "*)"}], 
      "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "seed\:304cNull\:3067\:3042\:308b\:3068", "\:3001", 
        "\:4e71\:6570\:306e\:7a2e\:306f\:4efb\:610f\:3068\:306a\:308b"}], " ",
        "*)"}], "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "seed\:304c\:6574\:6570\:3067\:3042\:308b\:3068", "\:3001", 
        "\:4e71\:6570\:306e\:7a2e\:304c\:56fa\:5b9a\:3055\:308c\:308b"}], " ",
        "*)"}], "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"RealVectorQ", "[", " ", "vec", " ", "]"}], "===", 
           "False"}], "||", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "int", "]"}], "===", "False"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"seed", "=!=", "Null"}], "&&", 
            RowBox[{
             RowBox[{"IntegerQ", "[", "seed", "]"}], "===", "False"}]}], 
           ")"}]}], ",", 
         RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"IntegerQ", ",", " ", "vec"}], "]"}], "]"}], "=!=", 
          RowBox[{"{", "True", "}"}]}], ",", " ", 
         RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "vec", "]"}], "<", "int"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           
           "\"\<The counts of integers in the premitted range must be equal \
to or more than the count of the resultatnt permutation.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}]}], "]"}], ";", "\n", 
       
       RowBox[{"output", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "@", "seed"}], ",", 
          RowBox[{
           RowBox[{"SeedRandom", "[", "seed", "]"}], ";", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"vec", ",", " ", "int"}], "]"}]}], ",", "\n", "\t\t", 
          RowBox[{"seed", "==", "Null"}], ",", 
          RowBox[{"RandomSample", "[", 
           RowBox[{"vec", ",", "int"}], "]"}], ",", "\n", "\t\t", "True", ",",
           " ", "error"}], "]"}]}], ";", "\n", 
       RowBox[{"Label", "[", "\"\<ending\>\"", "]"}], ";", "\n", "output"}]}],
      "\n", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullChecker", "[", 
     RowBox[{"bmlist0_", ",", " ", "bmitems0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nclen", ",", " ", "ji", ",", " ", "nbag", ",", " ", "nline", ",", " ",
         "nlout", ",", " ", "nljudge", ",", " ", "allmeans", ",", " ", 
        "address1", ",", " ", "func", ",", " ", "bpos", ",", " ", "bmean", 
        ",", " ", "rules1", ",", " ", "realpos", ",", " ", "allmedians", ",", 
        " ", "address2", ",", " ", "rules2", ",", " ", "ncleng", ",", " ", 
        "mbag", ",", " ", "mline", ",", "realrow", ",", " ", "emptyrow", ",", 
        " ", "emptyitems", ",", " ", "bmlist", ",", " ", "bmitems"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"non", "-", 
        RowBox[{
        "numeric", " ", "cells", " ", 
         "\:3092\:6570\:5b57\:3067\:7f6e\:304d\:63db\:3048\:308b"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\:8a08\:7b97\:3092\:4e2d\:65ad\:3055\:305b\:305f\:5834\:5408\:306f", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], " ", 
        "\:3092\:51fa\:529b\:3059\:308b"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nbag", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"mbag", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"nlout", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"func", "[", 
         RowBox[{"bpos_", ",", "bmean_"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{"bpos", "\[Rule]", " ", 
          RowBox[{"bmean", "[", 
           RowBox[{"[", 
            RowBox[{"bpos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Global`BMLIST0", "=", "bmlist0"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"ncleng", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Transpose", "[", "bmlist0", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "\:7a7a\:306e\:5217\:306e\:51e6\:7406", " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ji", "=", "1"}], ",", " ", 
         RowBox[{"ji", "\[LessEqual]", " ", "ncleng"}], ",", " ", 
         RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mline", "=", 
           RowBox[{
            RowBox[{"Transpose", "[", "bmlist0", "]"}], "[", 
            RowBox[{"[", "ji", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"mbag", ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"NumberQ", ",", " ", "mline"}], "]"}], "]"}], "===", 
               
               RowBox[{"{", "False", "}"}]}], ",", " ", "1", ",", " ", "0", 
              ",", " ", "0"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"mbag", ",", " ", "1"}], "]"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{"bmlist", "=", "bmlist0"}], ";", " ", 
          RowBox[{"bmitems", "=", "bmitems0"}], ";", 
          RowBox[{"Goto", "[", "\"\<nextphase\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"realrow", "=", 
        RowBox[{"NPosition", "[", 
         RowBox[{"mbag", ",", " ", "0"}], "]"}]}], ";", " ", 
       RowBox[{"emptyrow", "=", 
        RowBox[{"NPosition", "[", 
         RowBox[{"mbag", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bmlist", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Part", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "bmlist0", "]"}], ",", " ", "realrow"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"interlist", "=", "bmlist"}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"bmitems", "=", 
        RowBox[{"Part", "[", " ", 
         RowBox[{"bmitems0", ",", " ", "realrow"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"emptyitems", "=", 
        RowBox[{"MakeTwin", "[", 
         RowBox[{"emptyrow", ",", 
          RowBox[{"Part", "[", " ", 
           RowBox[{"bmitems0", ",", " ", "emptyrow"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<                                           \>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<\[EmptyDiamond] Completely empty or non-numeric rows were \
excluded.\\n  Their row numbers and item names are ``.\>\"", ",", " ", 
            "emptyitems"}], "]"}], ",", " ", "Bold", ",", " ", "15", ",", " ",
           "Red"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<                                                    \>\"", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<nextphase\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nclen", "=", 
        RowBox[{"Length", "[", "bmlist", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"nlout", "=", 
        RowBox[{"{", 
         RowBox[{"bmlist", ",", "bmitems"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "(*", " ", "\:7a7a\:306e\:30bb\:30eb\:306e\:51e6\:7406", " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", " ", 
        RowBox[{
         RowBox[{"ji", "=", "1"}], ",", " ", 
         RowBox[{"ji", "\[LessEqual]", " ", "nclen"}], ",", " ", 
         RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nline", "=", 
           RowBox[{"bmlist", "[", 
            RowBox[{"[", "ji", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"nbag", ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"NumberQ", ",", " ", "nline"}], "]"}], "]"}], "===", 
               
               RowBox[{"{", "True", "}"}]}], ",", " ", "0", ",", " ", "1", 
              ",", " ", "1"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"nbag", ",", " ", "1"}], "]"}], "===", "False"}], ",", 
         "  ", 
         RowBox[{"Goto", "[", "\"\<ncending\>\"", "]"}]}], "]"}], ";", 
       RowBox[{"Global`NBAG", "=", "nbag"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Global`BMLIST", "=", "bmlist"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<nljudgeagain\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nljudge", "=", 
        RowBox[{"InputString", "[", 
         RowBox[{
         "\"\<Some columns contain non-numeric cells.\\nTo test the accuracy \
of the created model on the training data, non-numeric cells must be replaced \
with a number.\\n\\nPress OK to replace empty cell with median value of the \
row.\\nType a to replace empty cell with average value of the row.\\nType x \
to excluede those columns.\\nType end to quit.\>\"", ",", " ", 
          RowBox[{"WindowMargins", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "10"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", " ", "10"}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"allmeans", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{"NMean", ",", " ", 
          RowBox[{"Transpose", "[", "bmlist", "]"}]}], "]"}]}], ";", 
       RowBox[{"Global`ALLMEANS", "=", "allmeans"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allmedians", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{"NMedian", ",", " ", 
          RowBox[{"Transpose", "[", "bmlist", "]"}]}], "]"}]}], ";", 
       RowBox[{"Global`ALLMEDIANS", "=", "allmedians"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"nljudge", "===", "\"\<end\>\""}], "||", 
          RowBox[{"nljudge", "===", "\"\<end\>\""}]}], ",", " ", 
         RowBox[{
          RowBox[{"nlout", "=", "\"\<terminated\>\""}], ";", 
          RowBox[{"Goto", "[", "\"\<ncending\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"nljudge", "===", "\"\<x\>\""}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"realpos", "=", 
           RowBox[{"NPosition", "[", 
            RowBox[{"nbag", ",", " ", "0"}], "]"}]}], ";", 
          RowBox[{"Global`REALPOS", "=", "realpos"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlout", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"bmlist", ",", " ", "realpos"}], "]"}], ",", 
             "bmitems"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                           \>\"",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Columns that contain non-numeric cells were excluded.\>\"", 
             ",", "15", ",", " ", "Purple", ",", " ", "Bold"}], "]"}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[EmptyDiamond] Initial N of columns = ``, Final N of \
columns = ``\>\"", ",", " ", "nclen", ",", " ", 
               RowBox[{"Length", "[", 
                RowBox[{"nlout", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", " ", 
             "15", ",", "Bold"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                           \>\"",
            "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nljudge", "===", "\"\<a\>\""}], "&&", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"NumberQ", ",", " ", "allmeans"}], "]"}], "]"}], "===", 
           RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"address1", "=", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"NumberQ", ",", " ", "bmlist", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", "False"}], "]"}]}],
           ";", 
          RowBox[{"Global`ADDRESS1", "=", "address1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rules1", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"func", "[", 
                 RowBox[{"#", ",", "allmeans"}], " ", "]"}], "&"}], ",", " ", 
               "address1"}], "]"}], ",", "1"}], "]"}]}], ";", 
          RowBox[{"Global`RULES1", "=", "rules1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlout", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{"bmlist", ",", " ", "rules1"}], "]"}], ",", "bmitems"}],
             "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                           \>\"",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[EmptyDiamond] Non-numeric cells were replaced with average \
values of the row.\>\"", ",", " ", "15", ",", "Purple", ",", " ", "Bold"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                           \>\"",
            "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nljudge", "===", "\"\<\>\""}], "&&", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"NumberQ", ",", " ", "allmedians"}], "]"}], "]"}], "===", 
           RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"address2", "=", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"NumberQ", ",", " ", "bmlist", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", "False"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"rules2", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"func", "[", 
                 RowBox[{"#", ",", "allmedians"}], "]"}], "&"}], ",", " ", 
               "address2"}], "]"}], ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlout", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{"bmlist", ",", " ", "rules2"}], "]"}], ",", "bmitems"}],
             "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                           \>\"",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[EmptyDiamond] Non-numeric cells were replaced with median \
values of the row.\>\"", ",", "15", ",", " ", "Purple", ",", " ", "Bold"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                           \>\"",
            "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nljudge", "===", "\"\<a\>\""}], "&&", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"NumberQ", ",", " ", "allmeans"}], "]"}], "]"}], "=!=", 
           RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ErrorMessage", "[", 
           RowBox[{
           "\"\<Type in again, because some rows have no numeric value.\>\"", 
            ",", "15", ",", " ", "Purple", ",", " ", "Bold"}], "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<nljudgeagain\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nljudge", "===", "\"\<m\>\""}], "&&", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"NumberQ", ",", " ", "allmedians"}], "]"}], "]"}], "=!=", 
           RowBox[{"{", "True", "}"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<Type in again, because some rows have no numeric value.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<nljudgeagain\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ErrorMessage", "[", "\"\<Type in, again.\>\"", "]"}], ";", 
          
          RowBox[{"Goto", "[", "\"\<nljudgeagain\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Global`NUMERICDATA", ",", "Global`NUMERICITEMS"}], "}"}], 
        "=", "nlout"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<ncending\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "nlout"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NGetCorrelation", "[", 
     RowBox[{"list_", ",", " ", "gcitems_"}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "explan", ",", " ", "trans", ",", " ", "target", ",", " ", "check", 
        ",", " ", "posT", ",", " ", "posF", ",", "output", ",", " ", 
        "newitems", ",", " ", "newdata", ",", " ", "newtarget", ",", " ", 
        "newtrans", ",", " ", "flag", ",", " ", "corrcoef", ",", " ", 
        "errorcheck", ",", "errorpos", ",", " ", "rpart"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "list", ":", " ", 
         "\:6700\:7d42\:5217\:3092\:76ee\:7684\:5909\:6570"}], "\:3001", 
        "\:305d\:308c\:4ee5\:5916\:3092\:8aac\:660e\:5909\:6570\:3068\:3059\
\:308b\:884c\:5217"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
      "(*", " ", 
       "\:5404\:8aac\:660e\:5909\:6570\:3068\:76ee\:7684\:5909\:6570\:3068\
\:306e\:76f8\:95a2\:4fc2\:6570\:3092\:6c42\:3081\:308b", " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list\:3068gcitems\:306f", "\:3001", 
        "DataIn\:3067\:5f97\:3089\:308c\:305fDATA\:3068ITEMS\:306b\:76f8\:5f53\
\:3059\:308b"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
      "(*", " ", "\:51fa\:529b\:306f\:5b9f\:6570\:5316\:3055\:308c\:308b", 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"{", 
         RowBox[{"list", ",", " ", "gcitems"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MatrixQ", "@", "list"}], "===", "False"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The input must be a matrix.\>\"", "]"}], 
          ";", 
          RowBox[{"flag", "=", "1"}], ";", 
          RowBox[{"Goto", "[", "\"\<gcending\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"target", "=", 
        RowBox[{"list", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"explan", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{"CutLast", ",", "list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"trans", "=", 
        RowBox[{"Transpose", "@", "explan"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"check", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Union", ",", 
          RowBox[{"Map", "[", " ", 
           RowBox[{"NumericQ", ",", " ", "trans", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posT", "=", 
        RowBox[{"NPosition", "[", " ", 
         RowBox[{"check", ",", " ", 
          RowBox[{"{", "True", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"posF", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"NPosition", "[", " ", 
           RowBox[{"check", ",", " ", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}]}], "]"}], ",", 
          RowBox[{"NPosition", "[", 
           RowBox[{"check", ",", " ", 
            RowBox[{"{", "False", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"posF", "===", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"corrcoef", "=", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Correlation", "[", 
               RowBox[{"#", ",", " ", "target"}], "]"}], "&"}], ",", " ", 
             "trans"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", "corrcoef"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Label", "[", "\"\<nullagain\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newdata", ",", " ", "newitems"}], "}"}], "=", 
           RowBox[{"NullChecker", "[", 
            RowBox[{"list", ",", " ", "gcitems"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"newdata", ",", " ", "newitems"}], "}"}], "===", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", " ", 
            RowBox[{"Goto", "[", "\"\<gcending\>\"", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newtarget", "=", 
           RowBox[{"newdata", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newtrans", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"CutLast", ",", "newdata"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Map", "[", 
               RowBox[{"Union", ",", 
                RowBox[{"Map", "[", " ", 
                 RowBox[{"NumericQ", ",", " ", "newtrans", ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"{", "True", "}"}], "}"}]}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"corrcoef", "=", 
              RowBox[{"Map", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Correlation", "[", 
                  RowBox[{"#", ",", "newtarget"}], "]"}], "&"}], ",", " ", 
                "newtrans"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", "corrcoef"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "ErrorMessage", "[", "\"\<All the elements must be numeric.\>\"",
               "]"}], ";", 
             RowBox[{"flag", "=", "1"}], ";", 
             RowBox[{"Goto", "[", "\"\<nullagain\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"errorcheck", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"NumericQ", ",", " ", "corrcoef"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"errorcheck", ",", " ", "False"}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"errorpos", "=", 
           RowBox[{"NPosition", "[", 
            RowBox[{"errorcheck", ",", "False"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rpart", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"ToExpression", ",", 
             RowBox[{"MapThread", "[", 
              RowBox[{"StringJoin", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"ToString", ",", "errorpos"}], "]"}], ",", " ", 
                 RowBox[{"Table", "[", " ", 
                  RowBox[{"\"\<\[Rule] Null\>\"", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"Length", "@", "errorpos"}], "}"}]}], "]"}]}], 
                "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"N", "@", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"corrcoef", ",", " ", "rpart"}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"output", "=", 
          RowBox[{"N", "@", "corrcoef"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<gcending\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowConfusionMatrix2", "[", 
     RowBox[{"pairlist0_", ",", " ", 
      RowBox[{"cutoff_", ":", "0.5"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sizefont1", "=", "16"}], ",", " ", 
        RowBox[{"sizefont2", "=", "14"}], ",", " ", "pairlist", ",", " ", 
        "listcheck", ",", " ", "listpos", ",", " ", "listlen", ",", " ", 
        "twinlist", ",", " ", "kinds", ",", " ", "rounded", ",", " ", 
        "rounder", ",", "elem", ",", " ", "inter1", ",", " ", "inter2", ",", 
        "pospos", ",", "posneg", ",", "negpos", ",", "negneg", ",", "cmdata", 
        ",", "ppvalue", ",", "npvalue", ",", "sensvalue", ",", "specvalue", 
        ",", "accuvalue", ",", "fvalue", ",", "cvalue", ",", "theta0", ",", 
        "thRange", ",", "testLabels", ",", "modelValues", ",", "aROCs", ",", 
        "ROCcurve", ",", "AUCvalue", ",", "rocFuncs", ",", "rocFuncTips", ",",
         "rocvalues", ",", "ROCgraph", ",", "triplebag", ",", " ", 
        RowBox[{"sizegraph", "=", "600"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"pairlist", ":", " ", 
        RowBox[{"a", " ", "list", " ", "composed", " ", "of", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"predicted", " ", "value"}], ",", " ", 
           RowBox[{"observed", " ", "value"}]}], "}"}]}]}], "  ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Preparation", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\[FilledSquare] Classification Performance in Confusion Matrix \
with ROC Curve\>\"", ",", " ", "Bold", ",", " ", "sizefont1", ",", " ", 
          "Purple"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ListQ", "@", "pairlist0"}], "===", "False"}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "pairlist0", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=!=", "2"}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The input data is inappropriate.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<SCMending\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"listcheck", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"NumberQ", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
            RowBox[{"NumberQ", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], ",", " ", 
          "pairlist0"}], "]"}]}], ";", " ", 
       RowBox[{"Global`LISTCHECK", "=", "listcheck"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"listcheck", ",", " ", "False"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"listpos", "=", 
           RowBox[{"NPosition", "[", " ", 
            RowBox[{"listcheck", ",", " ", "True"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<`` elements were omitted from the input due to non-number \
nature.\>\"", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", "pairlist0"}], "-", 
                RowBox[{"Length", "@", "listpos"}]}]}], "]"}], ",", 
             "sizefont2"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"pairlist", "=", 
           RowBox[{"NPosition", "[", " ", 
            RowBox[{"pairlist0", ",", " ", "listpos"}], "]"}]}], ";", 
          RowBox[{"listlen", "=", 
           RowBox[{"Length", "@", "pairlist"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<The length of data: `` (`` elements were omitted)\>\"", 
               ",", " ", "listlen", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", "pairlist0"}], "-", "listlen"}]}], 
              "]"}], ",", " ", "Bold", ",", " ", "sizefont2"}], "]"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pairlist", "=", "pairlist0"}], ";", " ", 
          RowBox[{"listlen", "=", 
           RowBox[{"Length", "@", "pairlist"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<The length of data: ``\>\"", ",", " ", "listlen"}],
               "]"}], ",", " ", "Bold", ",", " ", "sizefont2"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Global`PAIRLIST", "=", "pairlist"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kinds", "=", 
        RowBox[{"Union", "@", 
         RowBox[{"pairlist", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
       RowBox[{"Global`KINDS", "=", "kinds"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rounder", "[", "elem_", "]"}], ":=", " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"elem", "\[LessEqual]", " ", 
           RowBox[{"NMin", "@", "kinds"}]}], ",", " ", 
          RowBox[{"NMin", "@", "kinds"}], ",", "\[IndentingNewLine]", 
          RowBox[{"elem", "\[GreaterEqual]", " ", 
           RowBox[{"NMax", "@", "kinds"}]}], ",", " ", 
          RowBox[{"NMax", "@", "kinds"}], ",", "\[IndentingNewLine]", "True", 
          ",", " ", 
          RowBox[{"Round", "@", "elem"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"rounded", "=", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "kinds"}], "===", "2"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", ">=", " ", "cutoff"}], ",", " ", "1", ",", " ", 
               "0"}], "]"}], "&"}], ",", " ", 
            RowBox[{"pairlist", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Map", "[", " ", 
           RowBox[{"rounder", ",", " ", 
            RowBox[{"pairlist", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Global`ROUNDED", "=", "rounded"}], ";", "\[IndentingNewLine]", 
       RowBox[{"twinlist", "=", 
        RowBox[{"MakeTwin", "[", 
         RowBox[{"rounded", ",", " ", 
          RowBox[{"pairlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Global`TWINLIST", "=", "twinlist"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "kinds"}], "===", "2"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", 
                    "Confusion"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
            
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Matrix", " ", "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pospos", "=", 
           RowBox[{"Count", "[", 
            RowBox[{"twinlist", ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posneg", "=", 
           RowBox[{"Count", "[", 
            RowBox[{"twinlist", ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"negpos", "=", 
           RowBox[{"Count", "[", 
            RowBox[{"twinlist", ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"negneg", "=", 
           RowBox[{"Count", "[", 
            RowBox[{"twinlist", ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cmdata", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pospos", ",", " ", "posneg", ",", " ", 
               RowBox[{"pospos", "+", "posneg"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"negpos", ",", " ", "negneg", ",", " ", 
               RowBox[{"negpos", "+", "negneg"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pospos", "+", "negpos"}], ",", " ", 
               RowBox[{"posneg", "+", "negneg"}], ",", " ", 
               RowBox[{
               "pospos", "+", "posneg", "+", "negpos", "+", "negneg"}]}], 
              "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Global`CMDATA", "=", "cmdata"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ppvalue", "=", 
           RowBox[{"100.", " ", 
            RowBox[{"pospos", "/", 
             RowBox[{"(", 
              RowBox[{"pospos", "+", "posneg"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"npvalue", "=", 
           RowBox[{"100.", " ", 
            RowBox[{"negneg", "/", 
             RowBox[{"(", 
              RowBox[{"negpos", "+", "negneg"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sensvalue", "=", 
           RowBox[{"100.", " ", 
            RowBox[{"pospos", "/", 
             RowBox[{"(", 
              RowBox[{"pospos", "+", "negpos"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"specvalue", "=", 
           RowBox[{"100.", " ", 
            RowBox[{"negneg", "/", 
             RowBox[{"(", 
              RowBox[{"posneg", "+", "negneg"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"accuvalue", "=", 
           RowBox[{"100.", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pospos", "+", "negneg"}], ")"}], "/", "listlen"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"fvalue", "=", 
           RowBox[{"2.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ppvalue", "*", "sensvalue"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"ppvalue", "+", "sensvalue"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cvalue", "=", 
           RowBox[{
            RowBox[{"cStatistics", "[", "twinlist", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Global`FVALUE", "=", "fvalue"}], ";", " ", 
          RowBox[{"Global`CVALUE", "=", "cvalue"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`PPVALUE", "=", "ppvalue"}], ";", " ", 
          RowBox[{"Global`SENSVALUE", "=", "sensvalue"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ROC", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"theta0", "=", "0.01"}], ";", "\[IndentingNewLine]", 
          RowBox[{"thRange", "=", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "0.5"}], ",", " ", "1.5", ",", " ", "theta0"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Global`THRANGE", "=", "thRange"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"testLabels", "=", 
           RowBox[{"pairlist", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"modelValues", "=", 
           RowBox[{"pairlist", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"aROCs", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ToROCAssociation", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", "testLabels", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"#", ">", "theta"}], ",", "1", ",", "0"}], "]"}], 
                  "&"}], ",", "modelValues"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"theta", ",", "thRange"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ROCcurve", "=", 
           RowBox[{"ROCPlot", "[", 
            RowBox[{"thRange", ",", "aROCs", ",", 
             RowBox[{"\"\<PlotJoined\>\"", "\[Rule]", "Automatic"}], ",", 
             RowBox[{"\"\<ROCPointCallouts\>\"", "\[Rule]", "False"}], ",", 
             RowBox[{"\"\<ROCPointTooltips\>\"", "\[Rule]", "True"}], ",", 
             RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
             RowBox[{"ImageSize", "\[Rule]", " ", "sizegraph"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AUCvalue", "=", 
           RowBox[{"NF", "@", 
            RowBox[{"N", "@", 
             RowBox[{
              RowBox[{"ROCFunctions", "[", "\"\<AUROC\>\"", "]"}], "[", 
              "aROCs", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`TESTLABELS", "=", "testLabels"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`MODELVALUES", "=", "modelValues"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`AROCS", "=", "aROCs"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Global`ROCCURVE", "=", "ROCcurve"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`AUCVALUE", "=", "AUCvalue"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"rocFuncs", "=", 
           RowBox[{"{", 
            RowBox[{
            "\"\<PPV\>\"", ",", "\"\<NPV\>\"", ",", "\"\<TPR\>\"", ",", 
             "\"\<ACC\>\"", ",", "\"\<SPC\>\"", ",", "\"\<MCC\>\""}], "}"}]}],
           ";", 
          RowBox[{"rocFuncTips", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "<>", "\"\<, \>\"", "<>", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ROCFunctions", "[", "\"\<FunctionInterpretations\>\"", 
                  "]"}], "[", "#", "]"}], ")"}]}], "&"}], ",", "rocFuncs"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"inter1", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Through", "[", 
                RowBox[{
                 RowBox[{"ROCFunctions", "[", "rocFuncs", "]"}], "[", "#", 
                 "]"}], "]"}], "&"}], ",", "aROCs"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"inter2", "=", "rocFuncTips"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"rocvalues", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"thRange", ",", "#1"}], "}"}], "]"}], ",", "#2"}], 
               "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"inter1", ",", "inter2"}], "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`ROCVALUES", "=", "rocvalues"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ROCgraph", "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{"rocvalues", ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageSize", " ", "\[Rule]", " ", "sizegraph"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#", ",", "Larger"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<threshold, \[Theta]\>\"", ",", "\"\<rate\>\""}],
                  "}"}]}], "]"}]}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", "rocFuncTips"}], ",", 
             RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
             RowBox[{"PlotRange", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`ROCFUNCS", "=", "rocFuncs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`ROCFUNCTIPS", "=", "rocFuncTips"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Global`ROCGRAPH", "=", "ROCgraph"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[FilledSquare] Confusion Matrix\>\"", ",", " ", "Bold", ",",
              " ", "sizefont2", ",", " ", "Blue"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<                                      \>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"TableForm", "[", " ", 
              RowBox[{"cmdata", ",", " ", 
               RowBox[{"TableHeadings", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Predicted as 1\>\"", ",", "\"\<Predicted as 0\>\"", 
                    ",", "\"\<Total\>\""}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Observed as 1\>\"", ",", "\"\<Observed as 0\>\"", ",",
                     " ", "\"\<Total\>\""}], "}"}]}], "}"}]}]}], "]"}], ",", 
             "Bold", ",", "sizefont2"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<1. Accuracy(\:6b63\:78ba\:5ea6): ``%\>\"", ",", " ", 
               RowBox[{"NF", "@", "accuvalue"}]}], "]"}], ",", " ", "Bold", 
             ",", " ", "sizefont2", ",", " ", "Red"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<2. Precision(\:7cbe\:5ea6=\:967d\:6027\:7684\:4e2d\:7387): \
``%  NPV(\:9670\:6027\:7684\:4e2d\:7387): ``%\>\"", ",", " ", 
               RowBox[{"NF", "@", "ppvalue"}], ",", " ", 
               RowBox[{"NF", "@", "npvalue"}]}], "]"}], ",", " ", "Bold", ",",
              " ", "sizefont2", ",", " ", "Blue"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<3. Recall(\:518d\:73fe\:7387=\:611f\:5ea6): ``%  \
Specificity(\:7279\:7570\:5ea6): ``%\>\"", ",", " ", 
               RowBox[{"NF", "@", "sensvalue"}], ",", " ", 
               RowBox[{"NF", "@", "specvalue"}]}], "]"}], ",", " ", "Bold", 
             ",", " ", "sizefont2", ",", " ", "Blue"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<4. F1-measure(F1\:5024): ``  C-statistic(C\:7d71\:8a08\
\:91cf): ``\>\"", ",", " ", 
               RowBox[{"NF", "@", "fvalue"}], ",", " ", 
               RowBox[{"NF", "@", "cvalue"}]}], "]"}], ",", " ", "Bold", ",", 
             " ", "sizefont2"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<5. AUC of ROC curve: ``\>\"", ",", " ", "AUCvalue"}], 
              "]"}], ",", " ", "Bold", ",", " ", "Red", ",", " ", 
             "sizefont2"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[FilledSquare] Receiver Operating Characteristics \
Analysis\>\"", ",", " ", "Bold", ",", " ", "sizefont1", ",", " ", "Blue"}], 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[FilledDiamond] ROC curve\>\"", ",", " ", "Bold", ",", " ", 
             "sizefont2"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "@", "ROCcurve"}], ";", "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\[FilledDiamond] AUC of ROC curve: ``\>\"", ",", " ", 
               "AUCvalue"}], "]"}], ",", " ", "Bold", ",", " ", "Red", ",", 
             " ", "sizefont2"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[FilledDiamond] Effect of THRESHOLD between positive and \
negative\>\"", ",", " ", "Bold", ",", " ", "sizefont2"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "@", "ROCgraph"}], ";", "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "@", "kinds"}], "\[GreaterEqual]", " ", "3"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", 
                    "Confusion"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
            
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Matrix", " ", "--"}], "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pospos", "=", 
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"Map", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "===", " ", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", " ", 
               "twinlist"}], "]"}], ",", " ", "True"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"accuvalue", "=", 
           RowBox[{"100.", " ", 
            RowBox[{"pospos", "/", "listlen"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Global`ACCUVALUE", "=", "accuvalue"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ROC", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[FilledSquare] Confusion Matrix\>\"", ",", " ", "Bold", ",",
              " ", "sizefont2", ",", " ", "Blue"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<1. Accuracy(\:6b63\:78ba\:5ea6): ``%\>\"", ",", " ", 
               RowBox[{"NF", "@", "accuvalue"}]}], "]"}], ",", " ", "Bold", 
             ",", " ", "sizefont2", ",", " ", "Red"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PB", "[", "]"}]}], " ", ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<Unexpected kinds error.\>\"", "]"}], ";", 
          
          RowBox[{"Goto", "[", "\"\<SCMending\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"triplebag", "=", 
        RowBox[{"Fuse", "[", 
         RowBox[{
          RowBox[{"Fuse", "[", 
           RowBox[{
            RowBox[{"pairlist", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"twinlist", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"pairlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
       RowBox[{"Global`TRIPLEBAG", "=", "triplebag"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ExportExcel", "[", 
        RowBox[{"triplebag", ",", " ", 
         RowBox[{"Numberings", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Predicted\>\"", ",", "\"\<Rounded\>\"", ",", 
            "\"\<Observed\>\""}], "}"}], "]"}], ",", " ", 
         "\"\<ConfusionMatrixData\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{
          "StringForm", "[", 
           "\"\<\[FilledDiamond] The Raw Dataset for ROC analysis is \
expressed as TRIPLEBAG\\n  with {predicted value, rounded value, observed \
value}.\>\"", "]"}], ",", "14", ",", " ", "Bold"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PB", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<SCMending\>\"", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cStatistics", "[", "twopairs_", "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "occured", ",", " ", "free", ",", "occured0", ",", "free0", ",", " ", 
        RowBox[{"output", "=", "Null"}], ",", " ", "perc", ",", "resp", ",", 
        " ", "scores", ",", " ", "concord", ",", " ", "ele", ",", "vecd", ",",
         " ", "cstat", ",", " ", "accessnumb", ",", "pairnumb", ",", " ", 
        "n1", ",", "n2", ",", "n3", ",", "n4"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"twopairs", ":", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"estimated", " ", "ratio"}], ",", " ", 
             RowBox[{"1", " ", "or", " ", "0"}]}], "}"}], ",", " ", "..."}], 
          "}"}], " ", "or", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"estimated", " ", "value"}], ",", " ", 
             RowBox[{"actual", " ", "value"}]}], "}"}], ",", " ", 
           RowBox[{"...", ".."}]}], "}"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"concord", "[", 
         RowBox[{"ele_", ",", "vec_"}], "]"}], ":=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ele", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ">", " ", "#"}], ",", " ", "1",
              ",", " ", 
             RowBox[{
              RowBox[{"ele", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "===", "#"}], ",", "0.5", ",", 
             
             RowBox[{
              RowBox[{"ele", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", "#"}], ",", "0", ",", 
             "True", ",", " ", "0"}], "]"}], "&"}], ",", " ", 
          RowBox[{"vec", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"ele", ":", " ", "\:967d\:6027\:306e\:30b1\:30fc\:30b9"}], 
         ",", " ", 
         RowBox[{"vec", ":", " ", "\:9670\:6027\:306e\:30b1\:30fc\:30b9"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ListQ", "[", "twopairs", "]"}], "===", "False"}], "||", 
          RowBox[{
           RowBox[{"Length", "[", "twopairs", "]"}], "\[LessEqual]", "1"}]}], 
         ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The input is inappropriate.\>\"", "]"}], 
          ";", 
          RowBox[{"Goto", "[", "\"\<csend\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "twopairs", "]"}], "=!=", "3"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", "\"\<The input has inappropriate depth.\>\"", 
           "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<csend\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"perc", "=", 
        RowBox[{"twopairs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"resp", "=", 
        RowBox[{"twopairs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.`", ",", "0", ",", "1", ",", "1.`", ",", "Null"}],
                  "}"}], ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Union", "[", "resp", "]"}]}], "]"}], "]"}], "=!=", 
          RowBox[{"{", "True", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The second element should be either 0, 1 or Null.\>\"", "]"}],
           ";", 
          RowBox[{"Goto", "[", "\"\<csend\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"NumberQ", "[", "#", "]"}], "||", 
                 RowBox[{"#", "===", " ", "Null"}]}], ",", " ", "True", ",", 
                "False", ",", "False"}], "]"}], "&"}], ",", " ", "perc"}], 
            "]"}], "]"}], "=!=", 
          RowBox[{"{", "True", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The first element should be a real number between 0 and \
1.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<csend\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"occured0", "=", 
        RowBox[{"FilterElement", "[", " ", 
         RowBox[{"twopairs", ",", "2", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "1.`"}], "}"}], ",", " ", "#"}], "]"}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"free0", "=", 
        RowBox[{"FilterElement", "[", " ", 
         RowBox[{"twopairs", ",", " ", "2", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0.`"}], "}"}], ",", " ", "#"}], "]"}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"occured", "=", 
        RowBox[{"NullRemoving", "[", "occured0", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", "\:967d\:6027\:306e\:30b1\:30fc\:30b9", " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"free", "=", 
        RowBox[{"NullRemoving", "[", "free0", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", "\:9670\:6027\:306e\:30b1\:30fc\:30b9", " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "occured0", "]"}]}], ";", 
       RowBox[{"n2", "=", 
        RowBox[{"Length", "[", "occured", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n1", "-", "n2"}], ">", "0"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<`` elements were omitted from the first column due to \
non-number.\>\"", ",", " ", 
            RowBox[{"n1", "-", "n2"}]}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n3", "=", 
        RowBox[{"Length", "[", "free0", "]"}]}], ";", 
       RowBox[{"n4", "=", 
        RowBox[{"Length", "[", "free", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n3", "-", "n4"}], ">", "0"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<`` elements were omitted from the second column due to \
non-number.\>\"", ",", " ", 
            RowBox[{"n1", "-", "n2"}]}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scores", "=", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"concord", "[", 
            RowBox[{"#", ",", " ", "free"}], "]"}], "&"}], ",", " ", 
          "occured"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pairnumb", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", "scores", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"accessnumb", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"Flatten", "[", "scores", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cstat", "=", 
        RowBox[{"accessnumb", "/", "pairnumb"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"N", "[", "cstat", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"accessnumb", ",", " ", "pairnumb"}], "}"}], ",", "scores",
           ",", 
          RowBox[{"{", 
           RowBox[{"occured", ",", " ", "free"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "-", "statics"}], ",", " ", 
          RowBox[{"concordant", "+", 
           RowBox[{"0.5", "*", "ties"}]}], ",", " ", 
          RowBox[{"all", " ", "pairs"}], ",", " ", "comparison", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"with", " ", "events"}], ",", " ", 
            RowBox[{"without", " ", "events"}]}], "}"}]}], "}"}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<csend\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeterminationCoefficient", "[", 
     RowBox[{"obs_", ",", " ", "est_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"obs1", ",", "est1", ",", 
        RowBox[{"out", "=", 
         RowBox[{"{", 
          RowBox[{"obs", ",", "est"}], "}"}]}], ",", " ", "len1", ",", " ", 
        "len2", ",", "obsmean", ",", "estmean", ",", " ", "obsdiff", ",", " ",
         "estdiff", ",", " ", "obssquare", ",", " ", "estsquare", ",", " ", 
        "Rsquare"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:6570\:5024\:306e\:30d9\:30af\:30c8\:30eb\:304b\:3089\:6c7a\:5b9a\
\:4fc2\:6570R", "^", "2"}], "\:3092\:6c42\:3081\:308b"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\:89b3\:6e2c\:5024\:306e", " ", "obs", " ", 
        "\:306b\:5bfe\:3059\:308b", " ", "\:4e88\:6e2c\:5024", " ", "est", 
        " ", "\:306e\:6c7a\:5b9a\:4fc2\:6570\:3092\:6c42\:3081\:308b"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"VectorQ", "[", "obs", "]"}], "===", "False"}], "||", 
          RowBox[{
           RowBox[{"Depth", "@", "obs"}], "=!=", "2"}], "||", 
          RowBox[{
           RowBox[{"Length", "@", "obs"}], "<", "2"}]}], ",", " ", 
         RowBox[{"Goto", "[", "\"\<dcending\>\"", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"VectorQ", "[", "est", "]"}], "===", "False"}], "||", 
          RowBox[{
           RowBox[{"Depth", "@", "est"}], "=!=", "2"}], "||", 
          RowBox[{
           RowBox[{"Length", "@", "est"}], "<", "2"}]}], ",", " ", 
         RowBox[{"Goto", "[", "\"\<dcending\>\"", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"obs1", "=", 
        RowBox[{"StringRemoving", "[", "obs", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"est1", "=", 
        RowBox[{"StringRemoving", "[", "est", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"len1", "=", 
        RowBox[{
         RowBox[{"Length", "@", "obs1"}], "-", 
         RowBox[{"Length", "@", "obs"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"len2", " ", "=", 
        RowBox[{
         RowBox[{"Length", "@", "est1"}], "-", 
         RowBox[{"Length", "@", "est"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"len1", ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"ErrorMessage", "[", 
           RowBox[{
           "StringForm", "[", 
            "\"\<\[EmptyDiamond] `` entries were deleted because of \
non-numeric cells.\>\"", "]"}], "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<dcending\>\"", "]"}]}]}], "]"}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "obs1"}], "<", "2"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<\[EmptyDiamond]\:3000The length of the data is less than 2 \
after eliminating non-numeric entries.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<dcending\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"len2", ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"ErrorMessage", "[", 
           RowBox[{
           "StringForm", "[", 
            "\"\<\[EmptyDiamond] `` entries were deleted because of \
non-numeric cells.\>\"", "]"}], "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<dcending\>\"", "]"}]}]}], "]"}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "est1"}], "<", "2"}], ",", " ", 
         RowBox[{
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<\[EmptyDiamond]\:3000The length of the data is less than 2 \
after eliminating non-numeric entries.\>\"", "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<dcending\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"obsmean", "=", 
        RowBox[{"NMean", "[", "obs1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"estmean", "=", 
        RowBox[{"NMean", "[", "est1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"obsdiff", "=", 
        RowBox[{"obs1", "-", "obsmean"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"estdiff", "=", 
        RowBox[{"est1", "-", "estmean"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"obssquare", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"obsdiff", "^", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"estsquare", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"estdiff", "^", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Rsquare", "=", 
        RowBox[{"N", "[", 
         RowBox[{"estsquare", "/", "obssquare"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"Rsquare", ">", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"out", "=", 
           RowBox[{"1", "/", "Rsquare"}]}], ";", 
          RowBox[{
          "ErrorMessage", "[", 
           "\"\<The inverse value of the result was returned because the R \
square shoud be 1 or less.\>\"", "]"}]}], ",", " ", 
         RowBox[{"out", "=", "Rsquare"}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<dcending\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataIn", "[", "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"file", ",", " ", 
        RowBox[{"output", "=", 
         RowBox[{"{", "}"}]}], ",", " ", "raw", ",", " ", "len", ",", " ", 
        "i", ",", " ", "f", ",", " ", "vec", ",", " ", "data", ",", "item", 
        ",", " ", "probe", ",", " ", "extent", ",", " ", "filetype"}], "}"}], 
      ",", "\n", "\n", 
      RowBox[{
       RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";", "\n", 
       RowBox[{"ReinstallJava", "[", 
        RowBox[{"JVMArguments", " ", "->", " ", "\"\<-Xmx512m\>\""}], "]"}], 
       ";", "\n", "\n", 
       RowBox[{"file", "=", 
        RowBox[{"InputString", "[", 
         RowBox[{
         "\"\<Type in the FILE NAME of spread sheet, like data.xlsx.\\nOr \
like /Users/me/data.xls\\n\\nEach column should be composed of\\n{ID, start \
date, event date, censored date, factor1, ...}.\\nlike {1234, {2012,2,1}, \
Null, {2012,5,6}, male, ...}\\n or  {4567, 2012/2/3, 2012/6/7, Null, female, \
...}\\nType end to quit.   (ID is a dummy column.)\>\"", ",", " ", 
          RowBox[{"WindowMargins", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Automatic", ",", " ", "20"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "20"}], "}"}]}], "}"}]}]}], "]"}]}], 
       ";", 
       RowBox[{"Global`DIFILE", "=", "file"}], ";", "\n", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"file", " ", "===", "\"\<end\>\""}], "||", 
          RowBox[{"file", "===", "\"\<quit\>\""}]}], ",", " ", 
         RowBox[{"Goto", "[", "\"\<ends\>\"", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"probe", "=", 
        RowBox[{"NFindFile", "[", "file", "]"}]}], ";", 
       RowBox[{"Global`DIPROBE", "=", "probe"}], ";", "\n", 
       RowBox[{"raw", "=", 
        RowBox[{"Import", "[", "probe", "]"}]}], ";", 
       RowBox[{"Global`DIRAW", "=", "raw"}], ";", "\n", 
       RowBox[{"len", "=", 
        RowBox[{"Length", "[", "raw", "]"}]}], ";", 
       RowBox[{"Global`DILEN", "=", "len"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"raw", "=!=", "$Failed"}], ",", " ", 
         RowBox[{
          RowBox[{"extent", "=", 
           RowBox[{"StringTake", "[", 
            RowBox[{"probe", ",", " ", 
             RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"filetype", "=", 
           RowBox[{"Switch", "[", 
            RowBox[{
            "extent", ",", " ", "\"\<.csv\>\"", ",", " ", "0", ",", " ", 
             "\"\<.xls\>\"", ",", " ", "1", ",", " ", "\"\<xlsx\>\"", ",", 
             " ", "2", ",", " ", "_", " ", ",", " ", "\"\<error\>\""}], 
            "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "vec_", "]"}], ":=", " ", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "[", " ", "vec", "]"}], " ", "===", 
             RowBox[{"{", "Null", "}"}]}], ",", " ", "Null", ",", " ", 
            "vec"}], "]"}]}], ";"}], " ", "*)"}], "\n", "\n", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"probe", "===", "$Failed"}], ",", "\n", 
         RowBox[{"ErrorMessage", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<The `` was not found.\>\"", ",", " ", "file"}], "]"}],
           "]"}], ",", "\n", "\n", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", "filetype"}], 
           "]"}], "&&", 
          RowBox[{"len", "===", "1"}]}], ",", "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"data", "=", " ", 
            RowBox[{"cleandata2", "[", 
             RowBox[{"Rest", "[", 
              RowBox[{"raw", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}], ";"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "=", 
           RowBox[{"Rest", "[", 
            RowBox[{"raw", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", "\n", 
          RowBox[{"Clear", "[", "Global`DATA", "]"}], ";", 
          RowBox[{"Global`DATA", "=", "data"}], ";", "\n", 
          RowBox[{"item", "=", 
           RowBox[{"Numberings", "[", 
            RowBox[{"First", "[", 
             RowBox[{"raw", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", "\n", 
          RowBox[{"Clear", "[", "Global`ITEMS", "]"}], ";", " ", 
          RowBox[{"Global`ITEMS", "=", "item"}], ";", "\n", 
          RowBox[{"output", "=", 
           RowBox[{"{", 
            RowBox[{"item", ",", " ", "data"}], "}"}]}], ";", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<The file name: ``   Its dimensions: ``\>\"", ",", " ", 
             "file", ",", " ", 
             RowBox[{"Dimensions", "[", "data", "]"}]}], "]"}], "]"}], ";", 
          "\n", 
          RowBox[{
          "Print", "[", 
           "\"\<The body of data read in is expressed as DATA.\\nThe running \
numbered column name is expressed as ITEMS.\>\"", "]"}]}], ",", "\n", "\n", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", "filetype"}], 
           "]"}], "&&", 
          RowBox[{"len", ">=", " ", "2"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"Clear", "[", 
           RowBox[{"Global`DATA", ",", " ", "Global`ITEMS"}], "]"}], ";", 
          "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<The file name: ``\>\"", ",", " ", "file"}], "]"}], 
           "]"}], ";", "\n", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", " ", 
            RowBox[{"i", "<=", " ", "len"}], ",", " ", 
            RowBox[{"i", "++"}], ",", "\n", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"data", "[", "i", "]"}], "=", 
               RowBox[{"cleandata2", "[", 
                RowBox[{"Rest", "[", 
                 RowBox[{"raw", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}], ";"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", "i", "]"}], "=", 
              RowBox[{"Rest", "[", 
               RowBox[{"raw", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"Global`DATA", "[", "i", "]"}], "=", 
              RowBox[{"data", "[", "i", "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"item", "[", "i", "]"}], "=", 
              RowBox[{"Numberings", "[", 
               RowBox[{"First", "[", 
                RowBox[{"raw", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"Global`ITEMS", "[", "i", "]"}], "=", 
              RowBox[{"item", "[", "i", "]"}]}], ";", "\n", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"output", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"item", "[", "i", "]"}], ",", " ", 
                 RowBox[{"data", "[", "i", "]"}]}], "}"}]}], "]"}], ";", "\n", 
             RowBox[{"Print", "[", 
              RowBox[{"StringForm", "[", 
               RowBox[{
               "\"\<The dimensions of sheet ``: ``\>\"", ",", " ", "i", ",", 
                " ", 
                RowBox[{"Dimensions", "[", 
                 RowBox[{"data", "[", "i", "]"}], "]"}]}], "]"}], "]"}], 
             ";"}]}], "\n", "]"}], ";", "\n", 
          RowBox[{
          "Print", "[", 
           "\"\<The bodies of data read in are expressed as DATA[1], DATA[2], \
..., for each sheet.\\nThe column names are expressed as ITEMS[1], ITEMS[2], \
..., for each sheet.\>\"", "]"}]}], ",", "\n", "\[IndentingNewLine]", 
         RowBox[{"filetype", "===", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"raw", "=", 
           RowBox[{"{", "raw", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"data", "=", 
             RowBox[{"cleandata2", "[", 
              RowBox[{"Rest", "[", 
               RowBox[{"raw", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}], ";"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"data", "=", 
           RowBox[{"Rest", "[", 
            RowBox[{"raw", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", "\n", 
          RowBox[{"Clear", "[", "Global`DATA", "]"}], ";", 
          RowBox[{"Global`DATA", "=", "data"}], ";", "\n", 
          RowBox[{"item", "=", 
           RowBox[{"Numberings", "[", 
            RowBox[{"First", "[", 
             RowBox[{"raw", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", "\n", 
          RowBox[{"Clear", "[", "Global`ITEMS", "]"}], ";", " ", 
          RowBox[{"Global`ITEMS", "=", "item"}], ";", "\n", 
          RowBox[{"output", "=", 
           RowBox[{"{", 
            RowBox[{"item", ",", " ", "data"}], "}"}]}], ";", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<The file name: ``   Its dimensions: ``\>\"", ",", " ", 
             "file", ",", " ", 
             RowBox[{"Dimensions", "[", "data", "]"}]}], "]"}], "]"}], ";", 
          "\n", 
          RowBox[{
          "Print", "[", 
           "\"\<The body of data read in is expressed as DATA.\\nThe running \
numbered column name is expressed as ITEMS.\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "True", ",", 
         "\n", 
         RowBox[{
         "ErrorMessage", "[", "\"\<Unexpected DataIn error\>\"", "]"}]}], 
        "\n", "\n", "]"}], ";", "\n", 
       RowBox[{"Label", "[", "\"\<ends\>\"", "]"}], ";", "\n", "output"}]}], 
     "\n", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PruneEnsembleVariables", "[", " ", "ensemble_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "head", ",", "vari", ",", " ", "func", ",", " ", "pos", ",", "pos2", 
        ",", " ", 
        RowBox[{"output", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Input", ":", " ", 
        RowBox[{
        "an", " ", "ensemble", " ", "function", " ", "in", " ", "its", " ", 
         "phenotype", " ", "created", " ", "by", " ", "DataModeler"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Output", ":", " ", 
        RowBox[{
        "a", " ", "list", " ", "of", " ", "variables", " ", "that", " ", 
         "are", " ", "used", " ", "in", " ", "the", " ", "body", " ", "of", 
         " ", "the", " ", "ensemble"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"head", "=", 
        RowBox[{"Head", "[", "ensemble", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"head", "=!=", "Function"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "Style", "[", 
            "\"\<The input must be a Function in Mathematica with variables \
and a body of the function.\>\"", "]"}], "]"}], ";", 
          RowBox[{"Goto", "[", "\"\<ending\>\"", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vari", "=", 
        RowBox[{"ensemble", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
       RowBox[{"func", "=", 
        RowBox[{"ensemble", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", " ", 
          RowBox[{
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", " ", 
                  RowBox[{"func", ",", " ", "#"}], "]"}], "===", 
                 RowBox[{"{", "}"}]}], ",", " ", "0", ",", " ", "1", ",", 
                "0"}], "]"}], "&"}], ",", " ", "vari"}], "]"}], ",", "1"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos2", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"pos", ",", " ", 
          RowBox[{"Length", "@", "vari"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Global`PosVari", "=", "pos2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"vari", "[", 
         RowBox[{"[", "pos2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "\"\<ending\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"ROC", " ", "curve"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "ToROCAssociation", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "::", "nalbl"}], "=", 
    "\"\<The the first argument is expected to be list of two atomic \
elements,\nor a list of an atomic label and a list of atomic labels.\>\""}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "::", "nvecs"}], "=", 
    "\"\<The the second and third arguments are expected to be vectors of the \
same length.\>\""}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "::", "sgntrs"}], "=", 
    "\"\<The allowed signatures are one of : \\nToROCAssociation[ \
{trueLabel_?AtomQ, falseLabel:(_?AtomQ|{_?AtomQ..})}, actualLabels_, \
predictedLabels_ ] , \\nToROCAssociation[ {trueLabel_?AtomQ, \
falseLabel_?AtomQ}, apfAssoc_Association] .\>\""}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trueLabel_", ",", "falseLabel_"}], "}"}], ",", 
      "actualLabels_List", ",", "predictedLabels_List"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ra", ",", "localFalseLabel", ",", "flRules"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AtomQ", "[", "trueLabel", "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"AtomQ", "[", "falseLabel", "]"}], "||", 
              RowBox[{"MatchQ", "[", 
               RowBox[{"falseLabel", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"_", "?", "AtomQ"}], ".."}], "}"}]}], "]"}]}], 
             ")"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ToROCAssociation", "::", "nalbl"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"VectorQ", "[", "actualLabels", "]"}], "&&", 
            RowBox[{"VectorQ", "[", "predictedLabels", "]"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "actualLabels", "]"}], "\[Equal]", 
             RowBox[{"Length", "[", "predictedLabels", "]"}]}]}], ")"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ToROCAssociation", "::", "nvecs"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AtomQ", "[", "falseLabel", "]"}], ",", 
         RowBox[{
          RowBox[{"localFalseLabel", "=", "falseLabel"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ra", "=", 
           RowBox[{"Tally", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"actualLabels", ",", "predictedLabels"}], "}"}], "]"}], 
            "]"}]}]}], ",", 
         RowBox[{"(*", "ELSE", "*)"}], 
         RowBox[{
          RowBox[{"localFalseLabel", "=", 
           RowBox[{"\"\<Not-\>\"", "<>", 
            RowBox[{"ToString", "[", "trueLabel", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"flRules", "=", 
           RowBox[{"Dispatch", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"falseLabel", "\[Rule]", "localFalseLabel"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ra", "=", 
           RowBox[{"Tally", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"actualLabels", "/.", "flRules"}], ",", 
               RowBox[{"predictedLabels", "/.", "flRules"}]}], "}"}], "]"}], 
            "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ra", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Rule", "@@@", "ra"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ra", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Association", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Outer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}], "\[Rule]", "0"}], "&"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"trueLabel", ",", "localFalseLabel"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"trueLabel", ",", "localFalseLabel"}], "}"}]}], "]"}], 
            "]"}]}], ",", "ra"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToROCAssociation", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"trueLabel", ",", "localFalseLabel"}], "}"}], ",", "ra"}], 
        "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"trueLabel_", "?", "AtomQ"}], ",", 
        RowBox[{"falseLabel_", "?", "AtomQ"}]}], "}"}], ",", 
      "apfAssoc_Association"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Association", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<TruePositive\>\"", "\[Rule]", 
          RowBox[{"apfAssoc", "[", 
           RowBox[{"{", 
            RowBox[{"trueLabel", ",", "trueLabel"}], "}"}], "]"}]}], ",", 
         RowBox[{"\"\<FalsePositive\>\"", "\[Rule]", 
          RowBox[{"apfAssoc", "[", 
           RowBox[{"{", 
            RowBox[{"falseLabel", ",", "trueLabel"}], "}"}], "]"}]}], ",", 
         RowBox[{"\"\<TrueNegative\>\"", "\[Rule]", 
          RowBox[{"apfAssoc", "[", 
           RowBox[{"{", 
            RowBox[{"falseLabel", ",", "falseLabel"}], "}"}], "]"}]}], ",", 
         RowBox[{"\"\<FalseNegative\>\"", "\[Rule]", 
          RowBox[{"apfAssoc", "[", 
           RowBox[{"{", 
            RowBox[{"trueLabel", ",", "falseLabel"}], "}"}], "]"}]}]}], "}"}],
        "]"}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToROCAssociation", "[", "___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ToROCAssociation", "::", "sgntrs"}], "]"}], ";", "$Failed"}], 
     ")"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "ROCAssociationQ", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCAssociationQ", "[", "obj_", "]"}], ":=", 
    RowBox[{
     RowBox[{"AssociationQ", "[", "obj", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "obj", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<TruePositive\>\"", ",", "\"\<FalsePositive\>\"", ",", 
           "\"\<TrueNegative\>\"", ",", "\"\<FalseNegative\>\""}], "}"}]}], 
        "]"}], "]"}], "\[Equal]", "4"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TPR", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<FalseNegative\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TPR", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"TPR", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SPC", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<TrueNegative\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<FalsePositive\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<TrueNegative\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SPC", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"SPC", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPV", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<FalsePositive\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PPV", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"PPV", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NPV", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<TrueNegative\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<TrueNegative\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<FalseNegative\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NPV", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"NPV", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPR", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<FalsePositive\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<FalsePositive\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<TrueNegative\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FPR", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"FPR", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDR", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<FalsePositive\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<FalsePositive\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FDR", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"FDR", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FNR", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rocAssoc", "[", "\"\<FalseNegative\>\"", "]"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<FalseNegative\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FNR", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"FNR", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ACC", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rocAssoc", "[", "\"\<TruePositive\>\"", "]"}], "+", 
      RowBox[{"rocAssoc", "[", "\"\<TrueNegative\>\"", "]"}]}], ")"}], "/", 
    RowBox[{"Total", "[", 
     RowBox[{"Values", "[", "rocAssoc", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ACC", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"ACC", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FOR", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"NPV", "[", "rocAssoc", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FOR", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"FOR", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F1", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{"2", "*", 
    RowBox[{"PPV", "[", "rocAssoc", "]"}], "*", 
    RowBox[{
     RowBox[{"TPR", "[", "rocAssoc", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"PPV", "[", "rocAssoc", "]"}], "+", 
       RowBox[{"TPR", "[", "rocAssoc", "]"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F1", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"F1", ",", "rocs"}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "Note", " ", "the", " ", "addition", " ", "of", " ", "the", " ", 
           "points", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], " ", "and", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ".", "If"}], " ", "rps"}], "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ROCFunctions", "[", "\"\<FPR\>\"", "]"}], "/@", 
              "pROCs"}], ",", 
             RowBox[{
              RowBox[{"ROCFunctions", "[", "\"\<TPR\>\"", "]"}], "/@", 
              "pROCs"}]}], "}"}], "]"}]}], "]"}], " ", "has", " ", "points", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "p0"}], "}"}], " ", "and", " ", "at", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "p1"}], "}"}], " ", "then", " ", "after", " ", 
        "applying", " ", "Sort", " ", "and", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "2", ",", "1"}], "]"}]}], "&"}], " ", "we", " ", 
      "will", " ", "get", " ", "0"}], "-", 
     RowBox[{
     "length", " ", "intervals", " ", "and", " ", "correctly", " ", "ordered",
       " ", "pairs"}]}], ",", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "p0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "p0"}], "}"}], ",", "_"}], "}"}], ",", "___", 
        ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "p1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "p1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}], ".", "Hence"}], 
     " ", "the", " ", "trapezoidal", " ", "formula", " ", "integration", " ", 
     "is", " ", "going", " ", "to", " ", "work", " ", 
     RowBox[{"correctly", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AUROC", "[", 
    RowBox[{"pROCs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ROCFunctions", "[", "\"\<FPR\>\"", "]"}], "/@", 
              "pROCs"}], ",", 
             RowBox[{
              RowBox[{"ROCFunctions", "[", "\"\<TPR\>\"", "]"}], "/@", 
              "pROCs"}]}], "}"}], "]"}]}], "]"}]}], ",", "2", ",", "1"}], 
      "]"}], "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x2", "-", "x1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"y1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y2", "-", "y1"}], ")"}], "/", "2"}]}], ")"}]}]}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AUROC", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"AUROC", ",", "rocs"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MCC", "[", 
    RowBox[{"rocAssoc_", "?", "ROCAssociationQ"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tp", ",", "tn", ",", "fp", ",", "fn", ",", "tpfp", ",", "tpfn", ",", 
       "tnfp", ",", "tnfn"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tp", ",", "tn", ",", "fp", ",", "fn"}], "}"}], "=", 
       RowBox[{"Through", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"TPR", ",", "SPC", ",", "FPR", ",", "FNR"}], "}"}], "[", 
         "rocAssoc", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tpfp", ",", "tpfn", ",", "tnfp", ",", "tnfn"}], "}"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "0"}], ",", "1", ",", "#"}], "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tp", "+", "fp"}], ",", 
           RowBox[{"tp", "+", "fn"}], ",", 
           RowBox[{"tn", "+", "fp"}], ",", 
           RowBox[{"tn", "+", "fn"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tp", "*", "tn"}], "-", 
         RowBox[{"fp", "*", "fn"}]}], ")"}], "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"tpfp", "*", "tpfn", "*", "tnfp", "*", "tnfn"}], "]"}]}]}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MCC", "[", 
     RowBox[{"rocs", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "|>"}]}], ")"}]}], 
     "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"MCC", ",", "rocs"}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aROCAcronyms", "=", 
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<TPR\>\"", ",", "\"\<TNR\>\"", ",", "\"\<SPC\>\"", ",", 
        "\"\<PPV\>\"", ",", "\"\<NPV\>\"", ",", "\"\<FPR\>\"", ",", 
        "\"\<FDR\>\"", ",", "\"\<FNR\>\"", ",", "\"\<ACC\>\"", ",", 
        "\"\<AUROC\>\"", ",", "\"\<FOR\>\"", ",", "\"\<F1\>\"", ",", 
        "\"\<MCC\>\"", ",", "\"\<Recall\>\"", ",", "\"\<Precision\>\"", ",", 
        "\"\<Accuracy\>\"", ",", "\"\<Sensitivity\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<true positive rate\>\"", ",", "\"\<true negative rate\>\"", ",", 
        "\"\<specificity\>\"", ",", "\"\<positive predictive value\>\"", ",", 
        "\"\<negative predictive value\>\"", ",", 
        "\"\<false positive rate\>\"", ",", "\"\<false discovery rate\>\"", 
        ",", "\"\<false negative rate\>\"", ",", "\"\<accuracy\>\"", ",", 
        "\"\<area under the ROC curve\>\"", ",", 
        "\"\<false omission rate\>\"", ",", "\"\<F1 score\>\"", ",", 
        "\"\<Matthews correlation coefficient\>\"", ",", 
        "\"\<same as TPR\>\"", ",", "\"\<same as PPV\>\"", ",", 
        "\"\<same as ACC\>\"", ",", "\"\<same as TPR\>\""}], "}"}]}], "]"}]}],
    ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aROCFunctions", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"AssociationThread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<TPR\>\"", ",", "\"\<TNR\>\"", ",", "\"\<SPC\>\"", ",", 
          "\"\<PPV\>\"", ",", "\"\<NPV\>\"", ",", "\"\<FPR\>\"", ",", 
          "\"\<FDR\>\"", ",", "\"\<FNR\>\"", ",", "\"\<ACC\>\"", ",", 
          "\"\<AUROC\>\"", ",", "\"\<FOR\>\"", ",", "\"\<F1\>\"", ",", 
          "\"\<MCC\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "TPR", ",", "SPC", ",", "SPC", ",", "PPV", ",", "NPV", ",", "FPR", 
          ",", "FDR", ",", "FNR", ",", "ACC", ",", "AUROC", ",", "FOR", ",", 
          "F1", ",", "MCC"}], "}"}]}], "]"}], ",", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<Recall\>\"", ",", "\"\<Sensitivity\>\"", ",", 
          "\"\<Precision\>\"", ",", "\"\<Accuracy\>\"", ",", 
          "\"\<Specificity\>\"", ",", "\"\<FalsePositiveRate\>\"", ",", 
          "\"\<TruePositiveRate\>\"", ",", "\"\<FalseNegativeRate\>\"", ",", 
          "\"\<TrueNegativeRate\>\"", ",", "\"\<FalseDiscoveryRate\>\"", ",", 
          "\"\<FalseOmissionRate\>\"", ",", "\"\<F1Score\>\"", ",", 
          "\"\<AreaUnderROCCurve\>\"", ",", 
          "\"\<MatthewsCorrelationCoefficient\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "TPR", ",", "TPR", ",", "PPV", ",", "ACC", ",", "SPC", ",", "FPR", 
          ",", "TPR", ",", "FNR", ",", "SPC", ",", "FDR", ",", "FOR", ",", 
          "F1", ",", "AUROC", ",", "MCC"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "ROCFunctions", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "\"\<Methods\>\"", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<FunctionInterpretations\>\"", ",", "\"\<FunctionNames\>\"", ",", 
     "\"\<Functions\>\"", ",", "\"\<Methods\>\"", ",", "\"\<Properties\>\""}],
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "\"\<Properties\>\"", "]"}], ":=", 
   RowBox[{"ROCFunctions", "[", "\"\<Methods\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "\"\<FunctionNames\>\"", "]"}], ":=", 
   RowBox[{"Keys", "[", "aROCAcronyms", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "\"\<FunctionInterpretations\>\"", "]"}], ":=",
    "aROCAcronyms"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "\"\<FunctionsAssociation\>\"", "]"}], ":=", 
   "aROCFunctions"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "\"\<Functions\>\"", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Values", "[", "aROCFunctions", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"ROCFunctions", "[", "\"\<FunctionsAssociation\>\"", "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROCFunctions", "[", 
    RowBox[{"fnames", ":", 
     RowBox[{"{", 
      RowBox[{"_String", ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"aROCFunctions", "/@", "fnames"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCFunctions", "[", "fname_String", "]"}], ":=", 
    RowBox[{"aROCFunctions", "[", "fname", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "ROCPlot", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "::", "apv"}], "=", 
    "\"\<The parameter values are specified as Automatic, but extracting \
\\\"ROCParameter\\\" from the ROC data did not produce a numerical \
vector.\>\""}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ROCPlot", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<ROCPointSize\>\"", "\[Rule]", "0.02"}], ",", 
        RowBox[{"\"\<ROCColor\>\"", "\[Rule]", 
         RowBox[{"Lighter", "[", "Blue", "]"}]}], ",", 
        RowBox[{"\"\<ROCPointColorFunction\>\"", "\[Rule]", "Automatic"}], 
        ",", 
        RowBox[{"\"\<ROCPointTooltips\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<ROCPointCallouts\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<ROCCurveColorFunction\>\"", "\[Rule]", "Automatic"}], 
        ",", 
        RowBox[{"\"\<PlotJoined\>\"", "\[Rule]", "True"}]}], "}"}], ",", 
      RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCSpecQ", "[", "arg_", "]"}], ":=", 
    RowBox[{"MatchQ", "[", 
     RowBox[{"arg", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], ".."}], 
        "}"}], "|", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}]}], ")"}], 
         ".."}], "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "[", 
     RowBox[{
      RowBox[{"aROCs_", "?", "ROCSpecQ"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"ROCPlot", "[", 
     RowBox[{
     "\"\<FPR\>\"", ",", "\"\<TPR\>\"", ",", "Automatic", ",", "aROCs", ",", 
      "opts"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "[", 
     RowBox[{"parVals_List", ",", 
      RowBox[{"aROCs_", "?", "ROCSpecQ"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"ROCPlot", "[", 
     RowBox[{
     "\"\<FPR\>\"", ",", "\"\<TPR\>\"", ",", "parVals", ",", "aROCs", ",", 
      "opts"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "[", 
     RowBox[{"xFuncName_String", ",", "yFuncName_String", ",", 
      RowBox[{"aROCs_", "?", "ROCSpecQ"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"ROCPlot", "[", 
     RowBox[{
     "xFuncName", ",", "yFuncName", ",", "Automatic", ",", "aROCs", ",", 
      "opts"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "[", 
     RowBox[{"xFuncName_String", ",", "yFuncName_String", ",", 
      RowBox[{"parValsArg", ":", 
       RowBox[{"(", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], "|", "_List"}], 
        ")"}]}], ",", 
      RowBox[{"aROCs", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}], ".."}], 
        "}"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"ROCPlot", "[", 
     RowBox[{"xFuncName", ",", "yFuncName", ",", "parValsArg", ",", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "aROCs", "]"}], "]"}], ",", "aROCs"}], "]"}], 
      ",", "opts"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "[", 
     RowBox[{"xFuncName_String", ",", "yFuncName_String", ",", 
      RowBox[{"parValsArg", ":", 
       RowBox[{"(", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], "|", "_List"}], 
        ")"}]}], ",", 
      RowBox[{"aROCs", ":", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}]}], ")"}], 
         ".."}], "]"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rocCurveColorFunc", ",", "cls", ",", "grs"}], "}"}], ",", 
      RowBox[{
       RowBox[{"rocCurveColorFunc", "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{"ROCPlot", ",", "\"\<ROCCurveColorFunction\>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"rocCurveColorFunc", "===", "Automatic"}], "]"}], ",", 
         RowBox[{
          RowBox[{"rocCurveColorFunc", "=", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<DarkBands\>\"", ",", "\"\<ColorFunction\>\""}], 
            "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"cls", "=", 
        RowBox[{"rocCurveColorFunc", "/@", 
         RowBox[{"Rescale", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "aROCs", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"grs", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ROCPlot", "[", 
            RowBox[{
            "xFuncName", ",", "yFuncName", ",", "#2", ",", "opts", ",", 
             RowBox[{"\"\<PlotJoined\>\"", "\[Rule]", "True"}], ",", 
             RowBox[{"\"\<ROCColor\>\"", "\[Rule]", "#3"}]}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Keys", "[", "aROCs", "]"}], ",", 
            RowBox[{"Values", "[", "aROCs", "]"}], ",", "cls"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", 
        RowBox[{
         RowBox[{"Show", "[", "grs", "]"}], ",", 
         RowBox[{"SwatchLegend", "[", 
          RowBox[{"cls", ",", 
           RowBox[{"Keys", "[", "aROCs", "]"}]}], "]"}]}], "]"}]}]}], "]"}]}],
    ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCPlot", "[", 
     RowBox[{"xFuncName_String", ",", "yFuncName_String", ",", 
      RowBox[{"parValsArg", ":", 
       RowBox[{"(", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], "}"}], "|", "_List"}], 
        ")"}]}], ",", 
      RowBox[{"aROCs", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "ROCAssociationQ"}], ".."}], "}"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xFunc", ",", "yFunc", ",", "psize", ",", "rocc", ",", "pt", ",", 
         "pc", ",", "pj", ",", "rocpcf", ",", "points", ",", 
         RowBox[{"parVals", "=", "parValsArg"}], ",", "pred"}], "}"}], ",", 
       RowBox[{
        RowBox[{"psize", "=", 
         RowBox[{"OptionValue", "[", "\"\<ROCPointSize\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rocc", "=", 
         RowBox[{"OptionValue", "[", "\"\<ROCColor\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rocpcf", "=", 
         RowBox[{"OptionValue", "[", "\"\<ROCPointColorFunction\>\"", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pt", ",", "pc", ",", "pj"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"OptionValue", "[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ROCPointTooltips\>\"", ",", "\"\<ROCPointCallouts\>\"", ",", 
            "\"\<PlotJoined\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pj", "=", 
         RowBox[{"pj", "||", 
          RowBox[{
           RowBox[{"!", "pj"}], "&&", 
           RowBox[{"TrueQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<PlotJoined\>\"", "]"}], "===", 
             "Automatic"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xFunc", ",", "yFunc"}], "}"}], "=", 
         RowBox[{"ROCFunctions", "[", 
          RowBox[{"{", 
           RowBox[{"xFuncName", ",", "yFuncName"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"xFunc", ",", "yFunc"}], "}"}], "[", "#1", "]"}], 
             "]"}], "&"}], ",", "aROCs"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{"parVals", "===", "Automatic"}], "]"}], ",", 
          RowBox[{"parVals", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<ROCParameter\>\"", "]"}], "&"}], ",", 
             "aROCs"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"VectorQ", "[", 
              RowBox[{"parVals", ",", "NumericQ"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"ROCPlot", "::", "apv"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";"}], 
         "*)"}], 
        RowBox[{"pred", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"VectorQ", "[", 
             RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ",", "points"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"points", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"points", ",", "pred"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"parVals", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"parVals", ",", "pred"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"pj", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Lighter", "[", "rocc", "]"}], ",", 
                RowBox[{"Line", "[", "points", "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}], ",", 
            RowBox[{"PointSize", "[", "psize", "]"}], ",", "rocc", ",", 
            RowBox[{"If", "[", 
             RowBox[{"pj", ",", 
              RowBox[{"Line", "[", "points", "]"}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TrueQ", "[", 
                RowBox[{"rocpcf", "===", "Automatic"}], "]"}], "||", "pj"}], 
              ",", 
              RowBox[{"Which", "[", 
               RowBox[{"pt", ",", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", "#1", "]"}], ",", "#2"}], "]"}], 
                   "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"points", ",", "parVals"}], "}"}]}], "]"}], ",", 
                RowBox[{"!", "pt"}], ",", 
                RowBox[{"Point", "[", "points", "]"}], ",", "True", ",", 
                "Nothing"}], "]"}], ",", 
              RowBox[{"(*", "ELSE", "*)"}], 
              RowBox[{"Which", "[", 
               RowBox[{"pt", ",", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rocpcf", "[", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", "#1", "]"}], ",", "#2"}], "]"}]}], 
                    "}"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"points", ",", "parVals", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "points", "]"}], "]"}]}], "}"}]}], 
                 "]"}], ",", "True", ",", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rocpcf", "[", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
                    RowBox[{"Point", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"points", ",", "parVals", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "points", "]"}], "]"}]}], "}"}]}], 
                 "]"}]}], "]"}]}], "]"}], ",", "Black", ",", 
            RowBox[{"If", "[", 
             RowBox[{"pc", ",", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"#2", ",", "#1", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "&"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"points", ",", "parVals"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"StringRiffle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{
                    "ROCFunctions", "[", "\"\<FunctionInterpretations\>\"", 
                    "]"}], ",", "#", ",", "Nothing"}], "]"}]}], "}"}], ",", 
                  "\"\<, \>\""}], "]"}], ",", "Larger", ",", "Bold"}], "]"}], 
              "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"xFuncName", ",", "yFuncName"}], "}"}]}], "]"}]}], ",", 
          
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "\"\<ROCPointSize\>\"", "|", "\"\<ROCColor\>\"", "|", 
               "\"\<ROCPointColorFunction\>\"", "|", 
               "\"\<ROCPointTooltips\>\"", "|", "\"\<ROCPointCallouts\>\"", 
               "|", "\"\<ROCCurveColorFunction\>\"", "|", 
               "\"\<PlotJoined\>\""}], ")"}], "\[Rule]", "_"}]}], "]"}]}], 
         "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "parValsArg", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "aROCs", "]"}]}], "||", 
      RowBox[{"TrueQ", "[", 
       RowBox[{"parValsArg", "===", "Automatic"}], "]"}]}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "ROCValues", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "::", "nrng"}], "=", 
    "\"\<The range argument is expected to be a list of numbers between 0 and \
1.\>\""}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "::", "nlen"}], "=", 
    "\"\<The prediction probabilities Dataset object and the actual labels \
(the first and second arguments) are expected to have equal lengths.\>\""}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "::", "nlbl"}], "=", 
    "\"\<The value of \\\"ClassLabel\\\" is expected to be one of the columns \
of the first argument.\>\""}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "::", "args"}], "=", 
    "\"\<The arguments are expected to be a predictions probabilities \
Dataset, a list of actual labels, and threshold range.\>\""}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ROCValues", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"\"\<ClassLabel\>\"", "\[Rule]", "Automatic"}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "[", 
     RowBox[{"clRes_Dataset", ",", "testLabels_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"ROCValues", "[", 
     RowBox[{"clRes", ",", "testLabels", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "1", ",", "0.05"}], "]"}], ",", "opts"}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "[", 
     RowBox[{"predictionProbabilities_Dataset", ",", "actualLabels_List", ",", 
      RowBox[{"thRange_", "?", "VectorQ"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "focusClassLabel", ",", "classLabels", ",", "predictedLabels", ",", 
        "rocRes", ",", "mainLabel", ",", "notMainLabel", ",", 
        "modifiedActualLabels"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "predictionProbabilities", "]"}], 
          "\[NotEqual]", 
          RowBox[{"Length", "[", "actualLabels", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ROCValues", "::", "nlen"}], "]"}], ";", 
          "\[IndentingNewLine]", "$Failed"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"VectorQ", "[", 
             RowBox[{"thRange", ",", "NumberQ"}], "]"}], "&&", 
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "1", "\[GreaterEqual]", "#", "\[GreaterEqual]", "0"}], "&"}],
                 ",", "thRange"}], "]"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ROCValues", "::", "nrng"}], "]"}], ";", 
          "\[IndentingNewLine]", "$Failed"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"focusClassLabel", "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{"ROCValues", ",", "\"\<ClassLabel\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"focusClassLabel", "===", "Automatic"}], "]"}], ",", 
         RowBox[{"focusClassLabel", "=", 
          RowBox[{"First", "@", 
           RowBox[{"Normal", "@", 
            RowBox[{"Keys", "[", 
             RowBox[{"predictionProbabilities", "[", "1", "]"}], 
             "]"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Normal", "@", 
             RowBox[{"Keys", "[", 
              RowBox[{"predictionProbabilities", "[", "1", "]"}], "]"}]}], 
            ",", "focusClassLabel"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ROCValues", "::", "nlbl"}], "]"}], ";", 
          "\[IndentingNewLine]", "$Failed"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mainLabel", "=", 
        RowBox[{"ToString", "[", "focusClassLabel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"notMainLabel", "=", 
        RowBox[{"\"\<Not-\>\"", "<>", "mainLabel"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"modifiedActualLabels", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "mainLabel"}], ",", "#", ",", 
            "notMainLabel"}], "]"}], "&"}], "/@", "actualLabels"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"This", " ", "is", " ", "no", " ", "longer", " ", 
           RowBox[{"actual", ":", "classLabels"}]}], "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"Keys", "[", 
            RowBox[{"predictionProbabilities", "[", "1", "]"}], "]"}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"classLabels", "=", 
        RowBox[{"{", 
         RowBox[{"mainLabel", ",", "notMainLabel"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"predictedLabels", "=", 
           RowBox[{"Normal", "@", 
            RowBox[{"predictionProbabilities", "[", 
             RowBox[{"All", ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "th"}], 
                 ",", "mainLabel", ",", "notMainLabel"}], "]"}], "&"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rocRes", "=", 
           RowBox[{"ToROCAssociation", "[", 
            RowBox[{
            "classLabels", ",", "modifiedActualLabels", ",", 
             "predictedLabels"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"AssociationQ", "[", "rocRes", "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{"\"\<ROCParameter\>\"", "\[Rule]", "th"}], "|>"}], ",",
               "rocRes"}], "]"}], ",", "$Failed"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"th", ",", "thRange"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROCValues", "[", "___", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"ROCValues", "::", "args"}], "]"}], ";", 
       "\[IndentingNewLine]", "$Failed"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ToClassifyROCCurvePlot", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToClassifyROCCurvePlot", "[", "gr_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cols", ",", "pFunc"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"pFunc", "[", 
         RowBox[{"x_", ",", 
          RowBox[{"{", 
           RowBox[{"cedge_RGBColor", ",", "cface_RGBColor"}], "}"}]}], "]"}], 
        ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "cedge", "]"}], ",", 
          RowBox[{"FaceForm", "[", 
           RowBox[{"{", 
            RowBox[{"cface", ",", 
             RowBox[{"Opacity", "[", "0.34", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Polygon", "[", "x", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cols", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"gr", ",", "_RGBColor", ",", "Infinity"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gr", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", "x__", "]"}], "\[Rule]", 
           RowBox[{"pFunc", "[", 
            RowBox[{"x", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Blue", "]"}], ",", "LightBlue"}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"PointSize", "[", "x_", "]"}], "\[Rule]", 
           RowBox[{"PointSize", "[", "0.001", "]"}]}]}], "}"}]}]}]}], "]"}]}],
    ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Modified", "/", "productized"}], " ", "version", " ", "of", " ", 
     RowBox[{"kglr", "'"}], "s", " ", "MSE", " ", 
     RowBox[{"answer", ":", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", "a"}], 
      "/", "200221"}], "/", 
     RowBox[{"34008", "."}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "ConfusionMatrixPlot", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ConfusionMatrixPlot", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Normalize\>\"", "\[Rule]", "False"}], "}"}], ",", 
      RowBox[{"Options", "[", "MatrixPlot", "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConfusionMatrixPlot", "[", 
     RowBox[{
      RowBox[{"aROC_", "?", "ROCAssociationQ"}], ",", 
      RowBox[{"labelNames", ":", 
       RowBox[{"{", 
        RowBox[{"yesLabel_", ",", "noLabel_"}], "}"}], ":", 
       RowBox[{"{", 
        RowBox[{"\"\<True\>\"", ",", "\"\<False\>\""}], "}"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mat", ",", "refMat"}], "}"}], ",", 
      RowBox[{
       RowBox[{"mat", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"aROC", "[", "\"\<FalseNegative\>\"", "]"}], ",", 
            RowBox[{"aROC", "[", "\"\<TruePositive\>\"", "]"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"aROC", "[", "\"\<TrueNegative\>\"", "]"}], ",", 
            RowBox[{"aROC", "[", "\"\<FalsePositive\>\"", "]"}]}], "}"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"refMat", "=", "mat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"OptionValue", "[", 
           RowBox[{"ConfusionMatrixPlot", ",", "\"\<Normalize\>\""}], "]"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{"mat", "=", 
           RowBox[{"N", "[", 
            RowBox[{"mat", "/", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"aROC", "[", "\"\<TruePositive\>\"", "]"}], "+", 
                RowBox[{"aROC", "[", "\"\<FalseNegative\>\"", "]"}]}], ",", 
               RowBox[{
                RowBox[{"aROC", "[", "\"\<TrueNegative\>\"", "]"}], "+", 
                RowBox[{"aROC", "[", "\"\<FalsePositive\>\"", "]"}]}]}], 
              "}"}]}], "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ConfusionMatrixPlotFrame", "[", 
        RowBox[{
        "mat", ",", "refMat", ",", "labelNames", ",", "labelNames", ",", 
         "opts"}], "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "ConfusionMatrixPlotFrame", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ConfusionMatrixPlotFrame", "]"}], "=", 
    RowBox[{"Options", "[", "MatrixPlot", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConfusionMatrixPlotFrame", "[", 
     RowBox[{
      RowBox[{"mat_", "?", "MatrixQ"}], ",", "rowNames_List", ",", 
      "columnNames_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"ConfusionMatrixPlotFrame", "[", 
     RowBox[{
     "mat", ",", "mat", ",", "rowNames", ",", "columnNames", ",", "opts"}], 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConfusionMatrixPlotFrame", "[", 
     RowBox[{
      RowBox[{"mat_", "?", "MatrixQ"}], ",", 
      RowBox[{"refMat_", "?", "MatrixQ"}], ",", "rowNames_List", ",", 
      "columnNames_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"MatrixPlot", "[", 
       RowBox[{"mat", ",", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", 
          RowBox[{"Options", "[", "MatrixPlot", "]"}]}], "]"}], ",", 
        RowBox[{"ColorRules", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "White"}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<actual\>\"", ",", "\"\<predicted\>\""}], "}"}]}], ",", 
        
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "&"}], 
               ",", "rowNames"}], "]"}], ",", 
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "&"}], 
               ",", 
               RowBox[{"Total", "@", 
                RowBox[{"Transpose", "@", "refMat"}]}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "&"}], 
               ",", 
               RowBox[{"Total", "[", "refMat", "]"}]}], "]"}], ",", 
             RowBox[{"MapIndexed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "&"}], 
               ",", "columnNames"}], "]"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ","}], 
         "*)"}], 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"#", ",", 
              RowBox[{"#2", "-", 
               RowBox[{"1", "/", "2"}]}]}], "]"}], "&"}], ",", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Reverse", "@", "mat"}]}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConfusionMatrixPlotFrame", "[", 
     RowBox[{
      RowBox[{"smat_", "?", "AssociationQ"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"ConfusionMatrixPlotFrame", "[", 
        RowBox[{
         RowBox[{"Sequence", "@@", 
          RowBox[{"Values", "[", "smat", "]"}]}], ",", "opts"}], "]"}]}], 
      "]"}], "/;", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Keys", "[", "smat", "]"}], "]"}], "\[Equal]", 
      RowBox[{"Sort", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<SparseMatrix\>\"", ",", "\"\<RowNames\>\"", ",", 
         "\"\<ColumnNames\>\""}], "}"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"End", "[", "]"}], ";"}], "    "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EndPackage", "[", "]"}], ";"}], "     "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8521884303438683`*^9, 3.852188631067232*^9}, {
   3.852188668232774*^9, 3.852188689501994*^9}, {3.852188793552156*^9, 
   3.852188927465085*^9}, {3.85218896381036*^9, 3.852188983533927*^9}, {
   3.852189018585512*^9, 3.8521890663169403`*^9}, {3.852189156040125*^9, 
   3.852189182447219*^9}, {3.8521892960527287`*^9, 3.852189424150032*^9}, {
   3.852189521452477*^9, 3.852189615837843*^9}, {3.852189756596199*^9, 
   3.852189851004242*^9}, {3.852189907057499*^9, 3.852190111856182*^9}, {
   3.852190146935224*^9, 3.8521901578078537`*^9}, {3.852190210040956*^9, 
   3.852190210424872*^9}, {3.852190241473248*^9, 3.852190262938912*^9}, {
   3.852190353655685*^9, 3.85219041414168*^9}, {3.852190501372916*^9, 
   3.852190552313796*^9}, {3.85219064866929*^9, 3.852190724912031*^9}, {
   3.852190761229187*^9, 3.8521908943058443`*^9}, {3.8521909457783327`*^9, 
   3.852190946259614*^9}, {3.852190984396864*^9, 3.85219104031211*^9}, {
   3.8521911007735662`*^9, 3.85219118742857*^9}, {3.8521912415702553`*^9, 
   3.8521913928831987`*^9}, {3.852191553079281*^9, 3.852191592565515*^9}, {
   3.8521916491258583`*^9, 3.852191855046412*^9}, {3.852192019209515*^9, 
   3.852192019821393*^9}, {3.852192114155796*^9, 3.852192114681443*^9}, {
   3.852192148237997*^9, 3.852192247175674*^9}, {3.852192353178217*^9, 
   3.852192379576036*^9}, {3.852192428205514*^9, 3.8521924354670477`*^9}, {
   3.852192562518338*^9, 3.852192570821898*^9}, 3.852192611075498*^9, {
   3.8521926525790358`*^9, 3.852192670608204*^9}, {3.852192769135852*^9, 
   3.852192943510029*^9}, {3.8521930929367657`*^9, 3.852193145922555*^9}, {
   3.852193188392029*^9, 3.852193248842695*^9}, {3.852193300452203*^9, 
   3.8521933302485867`*^9}, {3.852193417469605*^9, 3.852193456669631*^9}, {
   3.85219353233993*^9, 3.852193609494698*^9}, {3.852193671205391*^9, 
   3.852193677769236*^9}, {3.852193723102977*^9, 3.8521937775449343`*^9}, {
   3.852193828205451*^9, 3.8521938614166737`*^9}, {3.8521939640527363`*^9, 
   3.8521940091333227`*^9}, {3.8521941017774687`*^9, 3.85219420726394*^9}, {
   3.8521943003024807`*^9, 3.852194309765009*^9}, {3.852194352077483*^9, 
   3.8521943891899548`*^9}, {3.8521944594284782`*^9, 
   3.8521944899851847`*^9}, {3.852194900955393*^9, 3.8521949089355583`*^9}, {
   3.85219494031443*^9, 3.8521949794544992`*^9}, {3.8521958227441607`*^9, 
   3.8521958400191317`*^9}, {3.8522002362803373`*^9, 3.852200279282469*^9}, {
   3.852200379841858*^9, 3.8522003895042753`*^9}, {3.8522004653630753`*^9, 
   3.8522004734778423`*^9}, {3.852200730654573*^9, 3.8522007312963943`*^9}, {
   3.852200781761951*^9, 3.8522008078145103`*^9}, {3.8522012167019873`*^9, 
   3.8522012172711687`*^9}, {3.852201924912806*^9, 3.852202149970974*^9}, {
   3.852202705031204*^9, 3.852202705741785*^9}, 3.852202785576289*^9, {
   3.852247214848238*^9, 3.8522474622037277`*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"5b868e8e-9a0f-43a7-a3b8-87513adf6591"]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 357}, {Automatic, 10}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) \
(2021\:5e7412\:67086\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"542bece0-9a29-48af-b342-19d825612c20"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 324434, 7822, 46907, "Input",ExpressionUUID->"5b868e8e-9a0f-43a7-a3b8-87513adf6591",
 InitializationCell->True]
}
]
*)

